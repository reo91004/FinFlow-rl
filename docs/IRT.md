# IRT (Immune Replicator Transport) ê¸°ìˆ  ë¬¸ì„œ

> **ìœ„ê¸° ì ì‘í˜• í¬íŠ¸í´ë¦¬ì˜¤ ê´€ë¦¬ë¥¼ ìœ„í•œ ë©´ì—­í•™ ì˜ê° ê°•í™”í•™ìŠµ í”„ë ˆì„ì›Œí¬**
>
> ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: 2025-10-16

## ëª©ì°¨

1. [í”„ë¡œì íŠ¸ ê°œìš”](#1-í”„ë¡œì íŠ¸-ê°œìš”)
2. [í•µì‹¬ ì•„ì´ë””ì–´](#2-í•µì‹¬-ì•„ì´ë””ì–´)
3. [ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜](#3-ì‹œìŠ¤í…œ-ì•„í‚¤í…ì²˜)
4. [ìˆ˜í•™ì  êµ¬ì„± ìš”ì†Œ](#4-ìˆ˜í•™ì -êµ¬ì„±-ìš”ì†Œ)
5. [ìœ„ê¸° ê°ì§€ ì‹œìŠ¤í…œ](#5-ìœ„ê¸°-ê°ì§€-ì‹œìŠ¤í…œ)
6. [í•™ìŠµ ë° í‰ê°€](#6-í•™ìŠµ-ë°-í‰ê°€)
7. [ì‚¬ìš© ê°€ì´ë“œ](#7-ì‚¬ìš©-ê°€ì´ë“œ)
8. [í•˜ì´í¼íŒŒë¼ë¯¸í„° ê°€ì´ë“œ](#8-í•˜ì´í¼íŒŒë¼ë¯¸í„°-ê°€ì´ë“œ)
9. [ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬](#9-ì„±ëŠ¥-ë²¤ì¹˜ë§ˆí¬)
10. [FAQ ë° ë¬¸ì œ í•´ê²°](#10-faq-ë°-ë¬¸ì œ-í•´ê²°)
11. [ì°¸ê³  ë¬¸í—Œ](#11-ì°¸ê³ -ë¬¸í—Œ)
12. [ë¶€ë¡](#12-ë¶€ë¡)

---

## 1. í”„ë¡œì íŠ¸ ê°œìš”

### 1.1 ë°°ê²½ ë° ë™ê¸°

ê¸ˆìœµ ì‹œì¥ì€ **ì •ìƒ êµ¬ê°„**ê³¼ **ìœ„ê¸° êµ¬ê°„**ì—ì„œ ì™„ì „íˆ ë‹¤ë¥¸ íŠ¹ì„±ì„ ë³´ì…ë‹ˆë‹¤:

- **ì •ìƒ êµ¬ê°„**: ë‚®ì€ ë³€ë™ì„±, ì˜ˆì¸¡ ê°€ëŠ¥í•œ íŒ¨í„´, ë¶„ì‚° íˆ¬ì ìœ ë¦¬
- **ìœ„ê¸° êµ¬ê°„**: ë†’ì€ ë³€ë™ì„±, ê¸‰ê²©í•œ ë³€í™”, ìƒê´€ê´€ê³„ ë¶•ê´´, ë°©ì–´ì  ì „ëµ í•„ìš”

ì¼ë°˜ì ì¸ ê°•í™”í•™ìŠµ ì•Œê³ ë¦¬ì¦˜ì€ **ë‹¨ì¼ ì •ì±…**ì„ í•™ìŠµí•˜ë¯€ë¡œ, ë‘ êµ¬ê°„ ëª¨ë‘ì— ìµœì ì¸ ì „ëµì„ ì°¾ê¸° ì–´ë µìŠµë‹ˆë‹¤. IRTëŠ” ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ **ì ì‘ ë©´ì—­ê³„(Adaptive Immune System)**ì—ì„œ ì˜ê°ì„ ë°›ì€ ë©”ì»¤ë‹ˆì¦˜ì„ ë„ì…í•©ë‹ˆë‹¤.

### 1.2 IRTë€?

**IRT (Immune Replicator Transport)**ëŠ” ë‹¤ìŒ ì„¸ ê°€ì§€ í•µì‹¬ ë©”ì»¤ë‹ˆì¦˜ì„ ê²°í•©í•œ ìœ„ê¸° ì ì‘í˜• í¬íŠ¸í´ë¦¬ì˜¤ ê´€ë¦¬ ì•Œê³ ë¦¬ì¦˜ì…ë‹ˆë‹¤:

1. **T-Cell Crisis Detection**: ë‹¤ì¤‘ ì‹ í˜¸ ê¸°ë°˜ ì‹¤ì‹œê°„ ìœ„ê¸° ê°ì§€
2. **Optimal Transport (OT)**: í˜„ì¬ ì‹œì¥ ìƒíƒœì™€ ì „ë¬¸ê°€ ì „ëµ ê°„ì˜ êµ¬ì¡°ì  ë§¤ì¹­
3. **Replicator Dynamics**: ê³¼ê±° ì„±ê³µ ì „ëµì— ëŒ€í•œ ì‹œê°„ ë©”ëª¨ë¦¬

### 1.3 ì£¼ìš” íŠ¹ì§•

- âœ… **ìœ„ê¸° ì ì‘í˜•**: ì‹œì¥ ìƒí™©ì— ë”°ë¼ ì „ëµì„ ë™ì ìœ¼ë¡œ ì¡°ì •
- âœ… **í•´ì„ ê°€ëŠ¥**: ê° êµ¬ì„± ìš”ì†Œì˜ ê¸°ì—¬ë„ ì‹œê°í™” ê°€ëŠ¥
- âœ… **ëª¨ë“ˆí™”**: SB3 SACì™€ ì™„ë²½ í†µí•©, ë‹¤ë¥¸ ì•Œê³ ë¦¬ì¦˜ ì ìš© ê°€ëŠ¥
- âœ… **ê²€ì¦ë¨**: Dow Jones 30 ì¢…ëª©, 2008-2024 ë°ì´í„°ë¡œ ê²€ì¦

### 1.4 ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­

**í™˜ê²½**:

- Python 3.8+
- CUDA (ì„ íƒì‚¬í•­, GPU ê°€ì†ìš©)

**í•µì‹¬ ì˜ì¡´ì„±**:

- `stable-baselines3>=2.0.0a5`: SAC ì•Œê³ ë¦¬ì¦˜
- `finrl==0.3.8`: í¬íŠ¸í´ë¦¬ì˜¤ í™˜ê²½
- `torch>=2.0.0`: ì‹ ê²½ë§ êµ¬í˜„
- `yfinance`: ì‹œì¥ ë°ì´í„° ë‹¤ìš´ë¡œë“œ

**ë°ì´í„°**:

- Yahoo Finance APIë¥¼ í†µí•œ Dow Jones 30 ì¢…ëª©
- í•™ìŠµ: 2009-2020 (12ë…„)
- í‰ê°€: 2021-2024 (4ë…„)

---

## 2. í•µì‹¬ ì•„ì´ë””ì–´

### 2.1 IRT ê³µì‹

IRTì˜ í•µì‹¬ì€ **ë‘ ê°€ì§€ ê²½ë¡œì˜ ë™ì  í˜¼í•©**ì…ë‹ˆë‹¤:

```
w_t = (1-Î±_c)Â·Replicator(w_{t-1}, f_t, c_t) + Î±_cÂ·Transport(E_t, K, C_t)
```

**êµ¬ì„± ìš”ì†Œ**:

- `w_t` [M]: Mê°œ í”„ë¡œí† íƒ€ì…(ì „ë¬¸ê°€ ì „ëµ)ì˜ í˜¼í•© ê°€ì¤‘ì¹˜
- `Î±_c` [0,1]: ìœ„ê¸° ì ì‘í˜• í˜¼í•© ë¹„ìœ¨
  - í‰ì‹œ(câ‰ˆ0): Î±_c â‰ˆ Î±_max (OT ì§€ë°°, ê· ë“± ë¶„ì‚° ì„ í˜¸)
  - ìœ„ê¸°(câ‰ˆ1): Î±_c â‰ˆ Î±_min (Replicator ì§€ë°°, fitness ê¸°ë°˜ ì„ íƒì  ì§‘ì¤‘)
- `f_t` [M]: Critic Q-value ê¸°ë°˜ í”„ë¡œí† íƒ€ì… ì í•©ë„
- `E_t` [mÃ—D]: ì—í”¼í† í”„(ìƒíƒœë¥¼ mê°œ í† í°ìœ¼ë¡œ ì¸ì½”ë”©)
- `K` [MÃ—D]: í•™ìŠµ ê°€ëŠ¥í•œ í”„ë¡œí† íƒ€ì… í‚¤

### 2.2 ì™œ íš¨ê³¼ì ì¸ê°€?

**1. ì •ìƒ êµ¬ê°„ (c â‰ˆ 0)**:

- Î±_c â‰ˆ 0.45 (OT ë¹„ì¤‘ ë†’ìŒ)
- OTê°€ ëª¨ë“  í”„ë¡œí† íƒ€ì…ì„ ê³ ë ¤í•˜ì—¬ ê· ë“± ë¶„ì‚°
- ì•ˆì •ì  ìˆ˜ìµ ì¶”êµ¬

**2. ìœ„ê¸° êµ¬ê°„ (c â‰ˆ 1)**:

- Î±_c â‰ˆ 0.08 (Replicator ë¹„ì¤‘ ë†’ìŒ)
- Replicatorê°€ Q-value ë†’ì€ í”„ë¡œí† íƒ€ì…ì— ì§‘ì¤‘
- ë¹ ë¥¸ ì ì‘ (Î· â†‘), ê²€ì¦ëœ ì „ëµ ì„ íƒ

**3. ë‹¤ì¤‘ ì‹ í˜¸ ìœ„ê¸° ê°ì§€**:

```
crisis = w_rÂ·T-Cell(ì‹œì¥í†µê³„+ê¸°ìˆ ì§€í‘œ)
       + w_sÂ·DSR(ì„±ëŠ¥ë³€í™”)
       + w_cÂ·CVaR(ê¼¬ë¦¬ìœ„í—˜)
```

### 2.3 ë©´ì—­í•™ì  ë¹„ìœ 

| ìƒë¬¼í•™               | IRT               | ì—­í•                           |
| -------------------- | ----------------- | ----------------------------- |
| **T-Cell**           | Crisis Detector   | ìœ„í˜‘(ìœ„ê¸°) ê°ì§€ ë° ì‹ í˜¸ ë°©ì¶œ  |
| **B-Cell**           | IRT Actor         | í•­ì²´(í¬íŠ¸í´ë¦¬ì˜¤) ìƒì„±         |
| **Antigen**          | Market State      | ì™¸ë¶€ í™˜ê²½ ì •ë³´                |
| **Epitope**          | State Tokens      | í•­ì›ì˜ ì¸ì‹ ê°€ëŠ¥ ë¶€ìœ„         |
| **Antibody**         | Expert Strategies | íŠ¹ì • ìƒí™©ì— íŠ¹í™”ëœ ì „ëµ       |
| **Affinity**         | Cost Matrix       | ì „ëµ-ìƒí™© ê°„ ì í•©ë„           |
| **Clonal Selection** | IRT Mixing        | ìƒí™©ì— ë§ëŠ” ì „ëµ ì„ íƒ ë° í˜¼í•© |

> **ì£¼ì˜**: ì´ëŠ” ì§ê´€ì„ ë•ê¸° ìœ„í•œ ë¹„ìœ ì…ë‹ˆë‹¤. IRTëŠ” ê°•í™”í•™ìŠµ í”„ë ˆì„ì›Œí¬ì´ë©°, "ë°©ì–´"ëŠ” í•™ìŠµëœ Q-functionì˜ ê²°ê³¼ì…ë‹ˆë‹¤.

---

## 3. ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

### 3.1 ì „ì²´ êµ¬ì¡° ë‹¤ì´ì–´ê·¸ë¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          SAC with IRT Actor                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                            â”‚
â”‚                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚                      â”Œâ”€â”€â”€â–ºâ”‚   Environment     â”‚â”€â”€â”€â”€â”                       â”‚
â”‚                      â”‚    â”‚      (MDP)        â”‚    â”‚                       â”‚
â”‚                      â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚                       â”‚
â”‚                  a_t â”‚                             â”‚ s_t+1                 â”‚
â”‚                      â”‚                             â”‚                       â”‚
â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚                       â”‚
â”‚            â”‚    Actor Ï€_Î¸       â”‚                  â”‚                       â”‚
â”‚            â”‚      (IRT)         â”‚                  â”‚                       â”‚
â”‚            â”‚                    â”‚                  â”‚                       â”‚
â”‚            â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                  â”‚                       â”‚
â”‚            â”‚  â”‚  T-Cell Det  â”‚  â”‚                  â”‚                       â”‚
â”‚            â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                  â”‚                       â”‚
â”‚            â”‚         â–¼          â”‚                  â”‚                       â”‚
â”‚            â”‚   Epitope Encoder  â”‚                  â”‚                       â”‚
â”‚            â”‚         â–¼          â”‚         (s,a,r,s',d)                     â”‚
â”‚            â”‚   IRT Operator     â”‚                  â”‚                       â”‚
â”‚            â”‚    (OT+Rep)        â”‚                  â–¼                       â”‚
â”‚            â”‚         â–¼          â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚            â”‚  Dirichlet Mixture â”‚        â”‚  Replay Buffer   â”‚              â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚   D={(s,a,r,..)} â”‚              â”‚
â”‚                      â–²                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                      â”‚                             â”‚                       â”‚
â”‚                      â”‚                     sample mini-batch               â”‚
â”‚                      â”‚                             â”‚                       â”‚
â”‚                      â”‚                             â–¼                       â”‚
â”‚                      â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚                      â”‚                   â”‚ Twin Critics     â”‚              â”‚
â”‚                      â”‚                   â”‚   Q_Ï•1, Q_Ï•2     â”‚              â”‚
â”‚                      â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                      â”‚                             â”‚                       â”‚
â”‚                      â”‚                             â”‚ Q(s, Ï€_j(s))          â”‚
â”‚                      â”‚                             â”‚   (fitness)           â”‚
â”‚                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                                                                            â”‚
â”‚  Training Update:                                                          â”‚
â”‚    Critic:  min ğ”¼[(Q_Ï•(s,a) - (r + Î³Q_target(s',a')))Â²]                    â”‚
â”‚    Actor:   max ğ”¼[Q_Ï•(s, Ï€_Î¸(s)) - Î±Â·log Ï€_Î¸(a|s)]                         â”‚
â”‚                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 IRT Actor ìƒì„¸ êµ¬ì¡°

```
                    Input State s_t âˆˆ â„^d  (d=181)
                           â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚                    â”‚                    â”‚
      â–¼                    â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Market     â”‚    â”‚   State      â”‚    â”‚  Q-value        â”‚
â”‚  Features   â”‚    â”‚   Features   â”‚    â”‚  Estimation     â”‚
â”‚  [12]       â”‚    â”‚   [181]      â”‚    â”‚  (Twin Critics) â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                  â”‚                     â”‚
       â–¼                  â–¼                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     Fitness [B,M]
â”‚  T-Cell      â”‚   â”‚  Epitope    â”‚             â”‚
â”‚  Detector    â”‚   â”‚  Encoder    â”‚             â”‚
â”‚              â”‚   â”‚             â”‚             â”‚
â”‚ crisis_level â”‚   â”‚  E [B,m,D]  â”‚             â”‚
â”‚ danger [B,D] â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
       â”‚                                        â”‚
       â”‚    Prototype Keys K [M,D]              â”‚
       â”‚            â”‚                           â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚    IRT Operator            â”‚
       â”‚    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”‚
       â”‚                            â”‚
       â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
       â”‚  â”‚ Optimal Transport    â”‚  â”‚
       â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚  â”‚
       â”‚  â”‚ Cost Matrix C        â”‚  â”‚
       â”‚  â”‚ Sinkhorn(C, Îµ)      â”‚  â”‚
       â”‚  â”‚ â†’ w_ot [B,M]        â”‚  â”‚
       â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
       â”‚                            â”‚
       â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
       â”‚  â”‚ Replicator Dynamics  â”‚  â”‚
       â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  â”‚
       â”‚  â”‚ Î·(c) = Î·_0 + Î·_1Â·c  â”‚  â”‚
       â”‚  â”‚ A = fitness - mean  â”‚  â”‚
       â”‚  â”‚ â†’ w_rep [B,M]       â”‚  â”‚
       â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
       â”‚                            â”‚
       â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
       â”‚  â”‚ Dynamic Mixing       â”‚  â”‚
       â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚  â”‚
       â”‚  â”‚ Î±_c = f(crisis, Î”s) â”‚  â”‚
       â”‚  â”‚ w = (1-Î±)Â·w_rep +   â”‚  â”‚
       â”‚  â”‚     Î±Â·w_ot          â”‚  â”‚
       â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼ w [B,M]
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚  Dirichlet Mixture         â”‚
       â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”‚
       â”‚                            â”‚
       â”‚  For j=1...M:              â”‚
       â”‚    decoder_j(K_j) â†’ Î±_j    â”‚
       â”‚                            â”‚
       â”‚  mixed_Î± = Î£ w_jÂ·Î±_j       â”‚
       â”‚                            â”‚
       â”‚  action ~ Dirichlet(Î±)     â”‚
       â”‚  or softmax(Î±/Ï„)           â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
            Portfolio Weights [B,n]
```

### 3.3 ë°ì´í„° íë¦„ ìš”ì•½

| ë‹¨ê³„                | ì…ë ¥                                  | ì¶œë ¥                 | ì°¨ì›            |
| ------------------- | ------------------------------------- | -------------------- | --------------- |
| **Environment**     | action                                | state                | [n] â†’ [d]       |
| **Market Features** | state                                 | market_features      | [d] â†’ [12]      |
| **T-Cell**          | market_features                       | crisis_level, danger | [12] â†’ [1], [D] |
| **Epitope Encoder** | state                                 | E                    | [d] â†’ [m,D]     |
| **Proto Keys**      | -                                     | K                    | [M,D]           |
| **Q-Networks**      | state, action                         | fitness              | [d],[n] â†’ [M]   |
| **IRT Operator**    | E, K, danger, w_prev, fitness, crisis | w                    | â†’ [M]           |
| **Decoders**        | K                                     | concentrations       | [M,D] â†’ [M,n]   |
| **Mixture**         | w, concentrations                     | action               | [M],[M,n] â†’ [n] |

**ì°¨ì› ë²”ë¡€**:

- `d=181`: ìƒíƒœ ì°¨ì›
- `n=30`: í–‰ë™ ì°¨ì› (ìì‚° ìˆ˜)
- `m=6`: ì—í”¼í† í”„ í† í° ìˆ˜
- `M=8`: í”„ë¡œí† íƒ€ì… ìˆ˜
- `D=128`: ì„ë² ë”© ì°¨ì›

### 3.4 ì£¼ìš” ëª¨ë“ˆ ê°œìš”

| ëª¨ë“ˆ                | íŒŒì¼                  | ì—­í•              | í•µì‹¬ ë©”ì„œë“œ/ì†ì„±                                       |
| ------------------- | --------------------- | ---------------- | ------------------------------------------------------ |
| **IRTPolicy**       | `irt_policy.py`       | SB3 SAC í†µí•©     | `make_actor()`, `get_irt_info()`                       |
| **IRTActorWrapper** | `irt_policy.py`       | Actor ì¸í„°í˜ì´ìŠ¤ | `forward()`, `action_log_prob()`, `_compute_fitness()` |
| **BCellIRTActor**   | `bcell_actor.py`      | IRT í•µì‹¬ êµ¬í˜„    | `forward()`, 6-step process                            |
| **IRT Operator**    | `irt_operator.py`     | OT + Replicator  | `forward()`, `_cost_matrix()`                          |
| **TCellMinimal**    | `t_cell.py`           | ìœ„ê¸° ê°ì§€        | `forward()`, EMA normalization                         |
| **StockTradingEnv** | `env_stocktrading.py` | í™˜ê²½             | `step()`, `reset()`                                    |

---

## 4. ìˆ˜í•™ì  êµ¬ì„± ìš”ì†Œ

### 4.1 IRT ì „ì²´ ìˆ˜ì‹

\[
\begin{aligned}
\text{[ìœ„ê¸° ê°ì§€]} \quad &c*t = \text{MultiSignal}(x^m_t, \Delta s_t, \text{CVaR}\_t) \\
\text{[ì—í”¼í† í”„]} \quad &E_t = \phi_s(s_t) \in \mathbb{R}^{m \times D} \\
\text{[ë¹„ìš© í–‰ë ¬]} \quad &C*{ij} = d*M(E_i, K_j) - \gamma \langle E_i, d_t \rangle + \lambda*{tol} \mathcal{T}_i + \rho \cdot \text{conf}\_j \\
\text{[OT]} \quad &P^*\_t = \arg\min_P \langle P, C \rangle + \varepsilon \text{KL}(P \| u \otimes v^\top), \quad w^{ot}\_t = P^*\_t \mathbf{1}\_m \\
\text{[Replicator]} \quad &\eta(c_t) = \eta_0 + \eta_1 c_t, \quad \tilde{w}\_t \propto w_{t-1} \cdot \exp\{\eta(c*t)(f_t - \bar{f}\_t) - r_t\} \\
\text{[ë™ì  í˜¼í•©]} \quad &\alpha_c = \alpha*{\max} + (\alpha*{\min} - \alpha*{\max}) \frac{1 - \cos(\pi c*t)}{2} \\
\text{[ìœµí•©]} \quad &w_t = (1-\alpha_c) w^{rep}\_t + \alpha_c w^{ot}\_t \\
\text{[Dirichlet]} \quad &\alpha_t = \sum*{j=1}^M w\_{t,j} \cdot \alpha_j(K_j), \quad a_t \sim \text{Dirichlet}(\alpha_t) \text{ or } \text{softmax}(\alpha_t/\tau)
\end{aligned}
\]

### 4.2 Optimal Transport (Sinkhorn)

**ëª©ì **: ì—í”¼í† í”„ $E \in \mathbb{R}^{m \times D}$ì™€ í”„ë¡œí† íƒ€ì… $K \in \mathbb{R}^{M \times D}$ ê°„ì˜ ìµœì  ìˆ˜ì†¡

**ìµœì í™” ë¬¸ì œ**:
\[
P^\* = \arg\min*{P \in \mathbb{R}^{m \times M}*+} \langle P, C \rangle + \varepsilon H(P)
\]
\[
\text{s.t.} \quad P \mathbf{1}\_M = u, \quad P^\top \mathbf{1}\_m = v
\]

**Sinkhorn ë°˜ë³µ** ($K = \exp(-C/\varepsilon)$):
\[
a \leftarrow u \oslash (K b), \quad b \leftarrow v \oslash (K^\top a), \quad P^\* = \text{diag}(a) K \text{diag}(b)
\]

**OT ë§ˆì§„**:
\[
w^{ot}_j = \sum_{i=1}^m P^\*\_{ij}
\]

**íŒŒë¼ë¯¸í„°**:

- $\varepsilon = 0.03$: ì—”íŠ¸ë¡œí”¼ ì •ê·œí™” (exploration)
- $u = v = \frac{1}{m}\mathbf{1}$: ê· ë“± ë§ˆì§„

### 4.3 Replicator Dynamics

**ê¸°ì›**: ì§„í™” ê²Œì„ ì´ë¡  (Hofbauer & Sigmund, 1998)

**IRT ì´ì‚° ë²„ì „**:
\[
\log \tilde{w}_{t,j} = \log w_{t-1,j} + \eta(c*t) \cdot (f*{t,j} - \bar{f}_t) - r_{t,j}
\]
\[
w^{rep}_{t,j} = \frac{\exp(\log \tilde{w}_{t,j} / \tau)}{\sum*k \exp(\log \tilde{w}*{t,k} / \tau)}
\]

**ìœ„ê¸° ê°€ì—´**:
\[
\eta(c_t) = \eta_0 + \eta_1 c_t
\]

- í‰ì‹œ ($c_t \approx 0$): $\eta \approx 0.05$
- ìœ„ê¸° ($c_t \approx 1$): $\eta \approx 0.17$

**íŒŒë¼ë¯¸í„°**:

- $\eta_0 = 0.05$, $\eta_1 = 0.12$
- $\tau = 1.4$: Temperature (ë¶„í¬ í‰íƒ„í™”)

### 4.4 ë©´ì—­í•™ì  ë¹„ìš© í•¨ìˆ˜

\[
C*{ij} = \underbrace{d_M(E_i, K_j)}*{\text{ê±°ë¦¬}} - \underbrace{\gamma \langle E*i, d_t \rangle}*{\text{ê³µìê·¹}} + \underbrace{\lambda*{tol} \mathcal{T}\_i}*{\text{ë‚´ì„±}} + \underbrace{\rho \cdot \text{conf}_j}_{\text{ì²´í¬í¬ì¸íŠ¸}}
\]

**êµ¬ì„± ìš”ì†Œ**:

1. **ë§ˆí• ë¼ë…¸ë¹„ìŠ¤ ê±°ë¦¬**: $d_M(x, y) = \sqrt{(x-y)^\top M (x-y)}$, $M = L^\top L$ (í•™ìŠµ ê°€ëŠ¥)
2. **ê³µìê·¹**: $\langle E_i, d_t \rangle$ (ìœ„ê¸° ì‹ í˜¸ì™€ ì •ë ¬ ì‹œ ë¹„ìš© â†“)
3. **ë‚´ì„±**: $\mathcal{T}_i = \text{ReLU}(\kappa \cdot \max_k \langle E_i, \sigma_k \rangle - \varepsilon_{tol})$ (ì‹¤íŒ¨ íŒ¨í„´ ì–µì œ)
4. **ì²´í¬í¬ì¸íŠ¸**: ê³¼ì‹  í”„ë¡œí† íƒ€ì… ì–µì œ

**íŒŒë¼ë¯¸í„°**:

- $\gamma = 0.85$, $\lambda_{tol} = 2.0$, $\rho = 0.3$
- $\kappa = 1.0$, $\varepsilon_{tol} = 0.1$

### 4.5 ë™ì  í˜¼í•© ê³„ìˆ˜

**ìœ„ê¸° ê¸°ë°˜**:
\[
\alpha*c(c_t) = \alpha*{\max} + (\alpha*{\min} - \alpha*{\max}) \frac{1 - \cos(\pi c_t)}{2}
\]

**Sharpe í”¼ë“œë°±**:
\[
\alpha'\_c = \alpha_c \cdot (1 + 0.25 \cdot \tanh(\Delta s_t))
\]

**íŒŒë¼ë¯¸í„°**:

- $\alpha_{\min} = 0.08$, $\alpha_{\max} = 0.45$

---

## 5. ìœ„ê¸° ê°ì§€ ì‹œìŠ¤í…œ

### 5.1 ë‹¤ì¤‘ ì‹ í˜¸ í†µí•©

IRTëŠ” ì„¸ ê°€ì§€ ë…ë¦½ ì‹ í˜¸ë¥¼ ê²°í•©:

```
crisis_raw = w_r Â· sigmoid(k_b Â· z_base)      # T-Cell ì‹œì¥ ì‹ í˜¸
           + w_s Â· sigmoid(-k_s Â· z_sharpe)    # DSR gradient
           + w_c Â· sigmoid(k_c Â· z_cvar)       # CVaR
```

**ê¸°ë³¸ ê°€ì¤‘ì¹˜**:

- `w_r = 0.55`: T-Cell (ì£¼ìš” ì„¼ì„œ)
- `w_s = -0.25`: DSR (ìŒìˆ˜: í•˜ë½=ìœ„ê¸°)
- `w_c = 0.20`: CVaR (ê¼¬ë¦¬ ìœ„í—˜)

### 5.2 T-Cell êµ¬ì¡°

**ì…ë ¥** [12ì°¨ì›]:

- ì‹œì¥ í†µê³„ (4ê°œ): balance, price_mean, price_std, cash_ratio
- ê¸°ìˆ  ì§€í‘œ (8ê°œ): macd, boll_ub, boll_lb, rsi_30, cci_30, dx_30, sma_30, sma_60

**ì¶œë ¥**:

- `crisis_types` [K=4]: ìœ„ê¸° íƒ€ì…ë³„ ì ìˆ˜
- `danger_embed` [D]: ê³µìê·¹ ì„ë² ë”©
- `crisis_base`: ê¸°ë³¸ ìœ„ê¸° í™•ë¥ 

**ì˜¨ë¼ì¸ ì •ê·œí™”**:
\[
z\_{std} = \frac{z - \mu}{\sqrt{\sigma^2 + \epsilon}}
\]

- EMA momentum = 0.92

### 5.3 ë°”ì´ì–´ìŠ¤/ì˜¨ë„ ë³´ì •

ëª©í‘œ ìœ„ê¸° ì ìœ ìœ¨ (`p_star=0.35`)ë¡œ ë³´ì •:

```python
crisis_affine = (crisis_raw - bias) / temperature
crisis_pre = sigmoid(crisis_affine)

if training:
    p_hat = crisis_pre.mean()
    bias += Î·_b Â· (p_hat - p_star)
    temperature *= (1 + Î·_T Â· (p_hat - p_star))
```

**íŒŒë¼ë¯¸í„°**:

- `Î·_b`: 0.02 â†’ 0.002 (cosine decay, 30k steps)
- `Î·_T = 0.01`
- `temperature_range = [0.9, 1.2]`

### 5.4 T-Cell Guard

ëª©í‘œ ë ˆì§ ì ìœ ìœ¨ë¡œ ìœ ë„:

```python
crisis_level = crisis_pre + guard_rate Â· (target - crisis_pre)
```

**íŒŒë¼ë¯¸í„°**:

- `crisis_target = 0.5`
- `guard_rate_init = 0.07` â†’ `guard_rate_final = 0.02` (7500 steps)

### 5.5 íˆìŠ¤í…Œë¦¬ì‹œìŠ¤

ë ˆì§ ì „í™˜ ì•ˆì •í™”:

```python
if prev_regime == CRISIS:
    regime = (crisis < 0.45) ? NORMAL : CRISIS
else:
    regime = (crisis > 0.55) ? CRISIS : NORMAL
```

---

## 6. í•™ìŠµ ë° í‰ê°€

### 6.1 í•™ìŠµ íŒŒì´í”„ë¼ì¸

**ìŠ¤í¬ë¦½íŠ¸**: `scripts/train_irt.py`

**ê¸°ë³¸ ëª…ë ¹**:

```bash
python scripts/train_irt.py --mode train --episodes 200
```

**ì£¼ìš” ë‹¨ê³„**:

1. ë°ì´í„° ë‹¤ìš´ë¡œë“œ (Yahoo Finance, Dow Jones 30)
2. ê¸°ìˆ  ì§€í‘œ ê³„ì‚° (MACD, Bollinger, RSI, CCI, DX, SMA)
3. í™˜ê²½ ìƒì„± (`StockTradingEnv`, `reward_type=adaptive_risk`)
4. SAC + IRTPolicy í•™ìŠµ
5. ì²´í¬í¬ì¸íŠ¸ ì €ì¥ (`logs/irt/<timestamp>/`)

**í•™ìŠµ ì„¤ì •**:

- Buffer size: 100,000
- Batch size: 256
- Learning rate: 1e-4
- Episodes: 200 (ì•½ 50,000 timesteps)

### 6.2 í‰ê°€

**ìŠ¤í¬ë¦½íŠ¸**: `scripts/evaluate.py`

**ê¸°ë³¸ ëª…ë ¹**:

```bash
python scripts/evaluate.py \
  --model logs/irt/20251005_123456/irt_final.zip \
  --method direct \
  --save-plot \
  --save-json
```

**í‰ê°€ ëª¨ë“œ**:

- `direct`: SB3 ëª¨ë¸ ì§ì ‘ ë¡œë“œ (IRT ì •ë³´ í¬í•¨)
- `drlagent`: FinRL DRLAgent API (SAC baseline ë¹„êµìš©)

**ìƒì„± ê²°ê³¼ë¬¼**:

- `evaluation_results.json`: 10ê°œ ë©”íŠ¸ë¦­
- `evaluation_plots/`: 14ê°œ ì‹œê°í™” (IRT íŠ¹í™” í¬í•¨)
- `xai/`: XAI ë¶„ì„ (Integrated Gradients)

### 6.3 ì‹œê°í™”

**IRT íŠ¹í™” í”Œë¡¯** (11ê°œ):

1. `irt_decomposition.png`: OT vs Replicator ê¸°ì—¬ë„
2. `portfolio_weights.png`: ì‹œê°„ë³„ í¬íŠ¸í´ë¦¬ì˜¤ ê°€ì¤‘ì¹˜
3. `crisis_levels.png`: ìœ„ê¸° ë ˆë²¨ ì¶”ì´
4. `prototype_weights.png`: í”„ë¡œí† íƒ€ì… í™œì„±í™” íŒ¨í„´
5. `stock_analysis.png`: ì¢…ëª©ë³„ ë¹„ì¤‘ ë¶„ì„
6. `performance_timeline.png`: ì„±ëŠ¥ ì‹œê³„ì—´
7. `benchmark_comparison.png`: ë²¤ì¹˜ë§ˆí¬ ë¹„êµ
8. `risk_dashboard.png`: ìœ„í—˜ ì§€í‘œ ëŒ€ì‹œë³´ë“œ
9. `tcell_analysis.png`: T-Cell ìœ„ê¸° íƒ€ì… ë¶„ì„
10. `attribution_analysis.png`: ì„±ëŠ¥ ê¸°ì—¬ë„ ë¶„ì„
11. `cost_matrix.png`: OT ë¹„ìš© í–‰ë ¬ íˆíŠ¸ë§µ

**ì¼ë°˜ í”Œë¡¯** (3ê°œ):

1. `portfolio_value.png`: í¬íŠ¸í´ë¦¬ì˜¤ ê°€ì¹˜ ì¶”ì´
2. `returns_distribution.png`: ìˆ˜ìµë¥  ë¶„í¬
3. `drawdown.png`: Drawdown ì¶”ì´

### 6.4 ëª¨ë¸ ë¹„êµ

**ìŠ¤í¬ë¦½íŠ¸**: `scripts/compare_models.py`

```bash
python scripts/compare_models.py \
  --model1 logs/sac \
  --model2 logs/irt \
  --output comparison_results
```

**ìƒì„± ê²°ê³¼**:

- `comparison_summary.json`: ë¹„êµ ë©”íŠ¸ë¦­
- `plots/`: 8ê°œ ë¹„êµ í”Œë¡¯
  - portfolio_value_comparison
  - drawdown_comparison
  - performance_metrics
  - risk_metrics
  - rolling_sharpe
  - crisis_response (IRT only)

---

## 7. ì‚¬ìš© ê°€ì´ë“œ

### 7.1 ë¹ ë¥¸ ì‹œì‘

**1. ì„¤ì¹˜**:

```bash
pip install -e .
```

**2. í•™ìŠµ**:

```bash
python scripts/train_irt.py --mode train --episodes 200
```

**3. í‰ê°€**:

```bash
python scripts/train_irt.py --mode eval \
  --model logs/irt/<timestamp>/irt_final.zip
```

**4. í†µí•© (í•™ìŠµ + í‰ê°€)**:

```bash
python scripts/train_irt.py --mode both --episodes 200
```

### 7.2 Python API ì‚¬ìš©

```python
from stable_baselines3 import SAC
from finrl.agents.irt import IRTPolicy
from finrl.meta.env_stock_trading.env_stocktrading import StockTradingEnv

# 1. í™˜ê²½ ìƒì„±
env = StockTradingEnv(
    df=train_data,
    reward_type='adaptive_risk',
    use_weighted_action=True,
    ...
)

# 2. IRT Policy ì„¤ì •
policy_kwargs = {
    "emb_dim": 128,
    "m_tokens": 6,
    "M_proto": 8,
    "alpha_min": 0.08,
    "alpha_max": 0.45,
    "eta_0": 0.05,
    "eta_1": 0.12,
    "eps": 0.03,
    ...
}

# 3. SAC + IRT ëª¨ë¸ ìƒì„±
model = SAC(
    policy=IRTPolicy,
    env=env,
    policy_kwargs=policy_kwargs,
    learning_rate=1e-4,
    buffer_size=100000,
    batch_size=256,
    verbose=1
)

# 4. í•™ìŠµ
model.learn(total_timesteps=50000)

# 5. ì €ì¥
model.save("irt_model.zip")

# 6. í‰ê°€
obs = env.reset()
for _ in range(len(test_data)):
    action, _ = model.predict(obs, deterministic=True)
    obs, reward, done, info = env.step(action)
    if done:
        break

# 7. IRT ì •ë³´ ì¶”ì¶œ
irt_info = model.policy.get_irt_info()
print(f"ìœ„ê¸° ë ˆë²¨: {irt_info['crisis_level']}")
print(f"í”„ë¡œí† íƒ€ì… ê°€ì¤‘ì¹˜: {irt_info['w']}")
print(f"ë™ì  Î±: {irt_info['alpha_c']}")
```

### 7.3 CLI ì¸ì

**í•™ìŠµ ê´€ë ¨**:

- `--episodes`: ì—í”¼ì†Œë“œ ìˆ˜ (ê¸°ë³¸: 200)
- `--seed`: ëœë¤ ì‹œë“œ (ê¸°ë³¸: 42)
- `--reward-type`: ë³´ìƒ í•¨ìˆ˜ (`adaptive_risk`, `dsr_cvar`, `basic`)
- `--env-diversify`: í™˜ê²½ ë‹¤ê°í™” (`none`, `rolling`, `random`)
- `--domain-rand-tx`: ê±°ë˜ ë¹„ìš© ëœë¤í™” (Â±%)
- `--domain-rand-slippage`: ìŠ¬ë¦¬í”¼ì§€ ëœë¤í™” (Â±%)

**IRT íŒŒë¼ë¯¸í„°**:

- `--alpha-min`, `--alpha-max`: Î± ë²”ìœ„
- `--eta-0`, `--eta-1`: Replicator í•™ìŠµë¥ 
- `--eps`: Sinkhorn ì—”íŠ¸ë¡œí”¼
- `--gamma`: ê³µìê·¹ ê°€ì¤‘ì¹˜
- `--w-r`, `--w-s`, `--w-c`: ìœ„ê¸° ì‹ í˜¸ ê°€ì¤‘ì¹˜

**í‰ê°€ ê´€ë ¨**:

- `--method`: í‰ê°€ ëª¨ë“œ (`direct`, `drlagent`)
- `--xai-level`: XAI ë¶„ì„ ìˆ˜ì¤€ (`none`, `basic`, `full`)
- `--save-plot`, `--save-json`: ê²°ê³¼ ì €ì¥

### 7.4 ë””ë²„ê¹…

**1. TensorBoard ë¡œê·¸ í™•ì¸**:

```bash
tensorboard --logdir logs/irt/<timestamp>/tensorboard
```

**ì£¼ìš” ë©”íŠ¸ë¦­**:

- `train/alpha_c_mean`: ë™ì  Î± í‰ê· 
- `train/crisis_level_mean`: ìœ„ê¸° ë ˆë²¨ í‰ê· 
- `train/w_rep_entropy`: Replicator ì—”íŠ¸ë¡œí”¼
- `train/w_ot_entropy`: OT ì—”íŠ¸ë¡œí”¼

**2. IRT ì •ë³´ ë¡œê¹…**:

```python
irt_info = model.policy.get_irt_info()

# ìœ„ê¸° ê°ì§€
print(f"Crisis Level: {irt_info['crisis_level'].mean():.3f}")
print(f"Crisis Regime: {irt_info['crisis_regime'].mean():.3f}")

# IRT ë¶„í•´
print(f"w_rep: {irt_info['w_rep'].mean(0)}")
print(f"w_ot: {irt_info['w_ot'].mean(0)}")
print(f"w (mixed): {irt_info['w'].mean(0)}")

# ë™ì  Î±
print(f"alpha_c: {irt_info['alpha_c'].mean():.3f}")

# Fitness
print(f"Fitness: {irt_info['fitness'].mean(0)}")
```

**3. ë‹¨ìœ„ í…ŒìŠ¤íŠ¸**:

```bash
pytest tests/test_irt_policy.py -v
```

---

## 8. í•˜ì´í¼íŒŒë¼ë¯¸í„° ê°€ì´ë“œ

### 8.1 í•µì‹¬ íŒŒë¼ë¯¸í„°

| íŒŒë¼ë¯¸í„°          | ê¸°ë³¸ê°’ | ë²”ìœ„      | ì„¤ëª…               | ì˜í–¥             |
| ----------------- | ------ | --------- | ------------------ | ---------------- |
| **êµ¬ì¡°**          |
| `emb_dim`         | 128    | 64-256    | ì„ë² ë”© ì°¨ì›        | í‘œí˜„ë ¥ vs ì—°ì‚°ëŸ‰ |
| `m_tokens`        | 6      | 4-8       | ì—í”¼í† í”„ í† í° ìˆ˜   | ìƒíƒœ ë‹¤ì¤‘ í‘œí˜„   |
| `M_proto`         | 8      | 6-12      | í”„ë¡œí† íƒ€ì… ìˆ˜      | ì „ë¬¸ê°€ ë‹¤ì–‘ì„±    |
| **ë™ì  í˜¼í•©**     |
| `alpha_min`       | 0.08   | 0.05-0.15 | ìœ„ê¸° ì‹œ ìµœì†Œ Î±     | Replicator ë¹„ì¤‘  |
| `alpha_max`       | 0.45   | 0.35-0.55 | í‰ì‹œ ìµœëŒ€ Î±        | OT ë¹„ì¤‘          |
| `ema_beta`        | 0.70   | 0.5-0.85  | w_prev EMA ê³„ìˆ˜    | ì‹œê°„ ë©”ëª¨ë¦¬      |
| **ìœ„ê¸° ê°ì§€**     |
| `w_r`             | 0.55   | 0.4-0.7   | T-Cell ê°€ì¤‘ì¹˜      | ì‹œì¥ ì‹ í˜¸ ë¯¼ê°ë„ |
| `w_s`             | -0.25  | -0.4~-0.1 | DSR ê°€ì¤‘ì¹˜         | ì„±ëŠ¥ í•˜ë½ ë¯¼ê°ë„ |
| `w_c`             | 0.20   | 0.1-0.3   | CVaR ê°€ì¤‘ì¹˜        | ê¼¬ë¦¬ ìœ„í—˜ ë¯¼ê°ë„ |
| **Replicator**    |
| `eta_0`           | 0.05   | 0.03-0.08 | ê¸°ë³¸ í•™ìŠµë¥         | í‰ì‹œ ì ì‘ ì†ë„   |
| `eta_1`           | 0.12   | 0.05-0.20 | ìœ„ê¸° ì¦ê°€ëŸ‰        | ìœ„ê¸° ì ì‘ ì†ë„   |
| `replicator_temp` | 1.4    | 0.9-2.0   | Softmax ì˜¨ë„       | ë¶„í¬ í‰íƒ„í™”      |
| **OT**            |
| `eps`             | 0.03   | 0.01-0.1  | ì—”íŠ¸ë¡œí”¼ ì •ê·œí™”    | Exploration      |
| `gamma`           | 0.85   | 0.5-1.0   | ê³µìê·¹ ê°€ì¤‘ì¹˜      | ìœ„ê¸° ì‹ í˜¸ ë¯¼ê°ë„ |
| `lambda_tol`      | 2.0    | 1.0-3.0   | ë‚´ì„± ê°€ì¤‘ì¹˜        | ì‹¤íŒ¨ íšŒí”¼        |
| **Dirichlet**     |
| `dirichlet_min`   | 0.8    | 0.1-1.0   | Concentration ìµœì†Œ | Sparsity         |
| `dirichlet_max`   | 20.0   | 5.0-50.0  | Concentration ìµœëŒ€ | Peakedness       |
| `action_temp`     | 0.8    | 0.3-1.0   | ê²°ì •ì  í–‰ë™ ì˜¨ë„   | í‰ê°€ ì‹œ ì§‘ì¤‘ë„   |

### 8.2 Ablation Study ì˜ˆì‹œ

**1. Î± ë²”ìœ„ ì¡°ì •**:

```bash
# ìœ„ê¸° ì‹œ Replicator ë¹„ì¤‘ ì¦ê°€
python scripts/train_irt.py --alpha-min 0.05 --alpha-max 0.55

# ìœ„ê¸° ì‹œ Replicator ë¹„ì¤‘ ê°ì†Œ
python scripts/train_irt.py --alpha-min 0.12 --alpha-max 0.35
```

**2. ìœ„ê¸° ì‹ í˜¸ ê°€ì¤‘ì¹˜ ì¡°ì •**:

```bash
# T-Cell ì‹ í˜¸ ê°•í™”
python scripts/train_irt.py --w-r 0.70 --w-s -0.15 --w-c 0.15

# DSR ì‹ í˜¸ ê°•í™” (ì„±ëŠ¥ í•˜ë½ ë¯¼ê°)
python scripts/train_irt.py --w-r 0.45 --w-s -0.35 --w-c 0.20
```

**3. Replicator ì ì‘ ì†ë„**:

```bash
# ë¹ ë¥¸ ì ì‘ (ë¶ˆì•ˆì • ìœ„í—˜)
python scripts/train_irt.py --eta-1 0.20

# ëŠë¦° ì ì‘ (ì•ˆì •ì )
python scripts/train_irt.py --eta-1 0.08
```

**4. OT Exploration**:

```bash
# ë†’ì€ ì—”íŠ¸ë¡œí”¼ (íƒìƒ‰ ì¦ê°€)
python scripts/train_irt.py --eps 0.05

# ë‚®ì€ ì—”íŠ¸ë¡œí”¼ (ì§‘ì¤‘ ì¦ê°€)
python scripts/train_irt.py --eps 0.01
```

### 8.3 íŒŒë¼ë¯¸í„° Phase ì§„í™”

IRTëŠ” ì—¬ëŸ¬ ì‹¤í—˜ì„ í†µí•´ íŒŒë¼ë¯¸í„°ë¥¼ ë³´ì •í–ˆìŠµë‹ˆë‹¤:

| Phase         | ì£¼ìš” ë³€ê²½                           | ëª©ì                      |
| ------------- | ----------------------------------- | ------------------------ |
| **Phase 1**   | ë‹¤ì¤‘ ì‹ í˜¸ (w_r, w_s, w_c)           | T-Cell + DSR + CVaR í†µí•© |
| **Phase 2**   | action_temp=0.8                     | ê²°ì •ì  í–‰ë™ ë¯¼ê°ë„       |
| **Phase 3**   | ema_beta=0.70                       | ì „ë‹¬ ê°ì‡  ì™„í™”           |
| **Phase 3.5** | dirichlet_min=0.8, alpha_min=0.05   | ê· ë“± í¡ì¸ ì™„í™”           |
| **Phase B**   | ë°”ì´ì–´ìŠ¤/ì˜¨ë„ ë³´ì •                  | ìœ„ê¸° ì ìœ ìœ¨ ì•ˆì •í™”       |
| **Phase E**   | eta_1=0.12, gamma=0.85              | Replicator ë¯¼ê°ë„ ì™„í™”   |
| **Phase F**   | alpha_max=0.45, replicator_temp=1.4 | OT ì¦ê°€, ë¶„í¬ í‰íƒ„í™”     |

---

## 9. ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬

### 9.1 ëª©í‘œ ë©”íŠ¸ë¦­

| ë©”íŠ¸ë¦­                | SAC Baseline | IRT ëª©í‘œ | ê°œì„ ìœ¨  |
| --------------------- | ------------ | -------- | ------- |
| **Sharpe Ratio**      | 1.0-1.2      | 1.3-1.5  | +15-20% |
| **ì „ì²´ Max Drawdown** | -30~-35%     | -18~-23% | -25-35% |
| **ìœ„ê¸° êµ¬ê°„ MDD**     | -40~-45%     | -22~-27% | -35-45% |
| **Calmar Ratio**      | 2.5-3.0      | 3.5-4.0  | +30-40% |

### 9.2 ìœ„ê¸° êµ¬ê°„ ì •ì˜

- **2020 COVID-19**: 2020-03 ~ 2020-06
- **2022 Fed ê¸ˆë¦¬ ì¸ìƒ**: 2022-01 ~ 2022-12

### 9.3 ì‹¤í—˜ ê²°ê³¼ (ì˜ˆì‹œ)

**ì „ì²´ êµ¬ê°„** (2021-2024):

- Sharpe: 1.35
- Calmar: 3.78
- Max Drawdown: -21.3%
- Annual Return: 18.2%

**ìœ„ê¸° êµ¬ê°„** (2020-03 ~ 2020-06):

- Max Drawdown: -24.5% (SAC: -42.1%)
- Recovery Time: 45ì¼ (SAC: 78ì¼)

**ì •ìƒ êµ¬ê°„** (2019-01 ~ 2019-12):

- Sharpe: 1.42 (SAC: 1.38)
- Annual Return: 16.5% (SAC: 15.8%)

### 9.4 í•´ì„ ê°€ëŠ¥ì„±

**IRT ë¶„í•´ ì˜ˆì‹œ**:

- í‰ì‹œ ìœ„ê¸° ë ˆë²¨: 0.28 Â± 0.12
- ìœ„ê¸° ì‹œ ìœ„ê¸° ë ˆë²¨: 0.73 Â± 0.15
- í‰ì‹œ Î±_c: 0.38 Â± 0.08 (OT 38%)
- ìœ„ê¸° ì‹œ Î±_c: 0.11 Â± 0.05 (OT 11%, Replicator 89%)

**í”„ë¡œí† íƒ€ì… í™œì„±í™”**:

- ì •ìƒ êµ¬ê°„: í”„ë¡œí† íƒ€ì… 2, 5, 7 í™œì„± (ë¶„ì‚° íˆ¬ì)
- ìœ„ê¸° êµ¬ê°„: í”„ë¡œí† íƒ€ì… 1, 4 í™œì„± (ë°©ì–´ì  ì „ëµ)

---

## 10. FAQ ë° ë¬¸ì œ í•´ê²°

### 10.1 ì¼ë°˜ ì§ˆë¬¸

**Q1: IRTëŠ” ì–´ë–¤ ì•Œê³ ë¦¬ì¦˜ê³¼ í˜¸í™˜ë˜ë‚˜ìš”?**

A: ê¸°ë³¸ì ìœ¼ë¡œ SACì™€ ìµœì í™”ë˜ì–´ ìˆì§€ë§Œ, Q-network ê¸°ë°˜ ì•Œê³ ë¦¬ì¦˜(TD3, DDPG)ê³¼ë„ í˜¸í™˜ ê°€ëŠ¥í•©ë‹ˆë‹¤. PPO/A2CëŠ” V(s) ê¸°ë°˜ì´ë¼ ìˆ˜ì • í•„ìš”.

**Q2: Î± â†“ëŠ” ë³´ìˆ˜ì  ì „ëµì„ ì˜ë¯¸í•˜ë‚˜ìš”?**

A: **ì•„ë‹™ë‹ˆë‹¤**. Î± â†“ëŠ” Replicator ë¹„ì¤‘ ì¦ê°€ë¥¼ ì˜ë¯¸í•˜ë©°, ì´ëŠ” Q-value ë†’ì€ í”„ë¡œí† íƒ€ì…ì— "ì§‘ì¤‘"í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ê²ƒì´ ë°©ì–´ì ì¸ì§€ëŠ” í•™ìŠµëœ Q-functionì— ë‹¬ë ¤ìˆìŠµë‹ˆë‹¤.

**Q3: ë‹¤ë¥¸ ìì‚° í´ë˜ìŠ¤ì— ì ìš© ê°€ëŠ¥í•œê°€ìš”?**

A: ë„¤, ì•”í˜¸í™”í, ì±„ê¶Œ, ìƒí’ˆ ë“±ì— ì ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤. í™˜ê²½ì˜ `df` ë°ì´í„°ë§Œ ë³€ê²½í•˜ë©´ ë©ë‹ˆë‹¤.

**Q4: í•™ìŠµ ì‹œê°„ì€ ì–¼ë§ˆë‚˜ ê±¸ë¦¬ë‚˜ìš”?**

A: GPU (RTX 3090) ê¸°ì¤€ ì•½ 2-3ì‹œê°„ (200 episodes). CPUëŠ” 8-12ì‹œê°„.

**Q5: IRT ì •ë³´ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ë¡œê¹…í•˜ë ¤ë©´?**

A: Custom callback ì‚¬ìš©:

```python
from stable_baselines3.common.callbacks import BaseCallback

class IRTLoggingCallback(BaseCallback):
    def _on_step(self):
        if self.n_calls % 100 == 0:
            irt_info = self.model.policy.get_irt_info()
            self.logger.record("irt/crisis_level", irt_info['crisis_level'].mean())
            self.logger.record("irt/alpha_c", irt_info['alpha_c'].mean())
        return True

model.learn(total_timesteps=50000, callback=IRTLoggingCallback())
```

### 10.2 ë¬¸ì œ í•´ê²°

**Q1: NaN ë°œìƒ (loss/Q-value)**

**ì›ì¸**: ìˆ˜ì¹˜ ë¶ˆì•ˆì • (Sinkhorn, Replicator)

**í•´ê²°**:

1. Sinkhorn tolerance ì¦ê°€: `tol=1e-4` â†’ `1e-3`
2. Replicator clamp ê°•í™”: `w_prev + 1e-8` â†’ `w_prev + 1e-6`
3. Learning rate ê°ì†Œ: `1e-4` â†’ `5e-5`

**Q2: Î±ê°€ ì¢ì€ ë²”ìœ„ì— ê³ ì°©**

**ì›ì¸**: Reward í•¨ìˆ˜ì™€ T-Cell ë°©í–¥ ì¶©ëŒ

**í•´ê²°**: Adaptive-risk rewardì˜ `crisis_gain` ë¶€í˜¸ ë°˜ì „

```python
# reward_functions.py
crisis_gain = -0.15  # 0.25 â†’ -0.15
```

**Q3: ìœ„ê¸° ê°ì§€ê°€ ë„ˆë¬´ ë¯¼ê°/ë‘”ê°**

**í•´ê²°**:

- ë¯¼ê°: `k_b`, `k_s`, `k_c` ê°ì†Œ (4.0 â†’ 3.0)
- ë‘”ê°: ìœ„ ê°’ ì¦ê°€ (4.0 â†’ 5.0)
- ë˜ëŠ” ê°€ì¤‘ì¹˜ ì¡°ì • (`w_r`, `w_s`, `w_c`)

**Q4: Replicatorê°€ ê· ë“± ë¶„í¬ì— ê³ ì°©**

**ì›ì¸**: Temperature ë„ˆë¬´ ë†’ìŒ

**í•´ê²°**: `replicator_temp` ê°ì†Œ (1.4 â†’ 1.0)

**Q5: í•™ìŠµ ì´ˆê¸° ë¶ˆì•ˆì •**

**í•´ê²°**:

1. Replay buffer warmup ì¦ê°€: `learning_starts=10000`
2. Crisis guard rate ì¦ê°€: `crisis_guard_rate_init=0.15`
3. EMA beta ì¦ê°€: `ema_beta=0.80`

### 10.3 Reward í•¨ìˆ˜ ì¶©ëŒ ë¬¸ì œ

**âš ï¸ í˜„ì¬ ë¬¸ì œ**:

```
T-Cell:  ìœ„ê¸° â†’ Î±â†“ â†’ Replicator í™œì„± â†’ ì§‘ì¤‘
Reward:  ìœ„ê¸° â†’ Îºâ†‘ â†’ Sharpe bonus ì¦ê°€ â†’ ê³ ìˆ˜ìµ ì¶”êµ¬

â†’ ì¶©ëŒ! Î±ê°€ ì¢ì€ ë²”ìœ„ì— ê³ ì°©
```

**ê¶Œì¥ í•´ê²°ì±…**:

`finrl/meta/env_stock_trading/reward_functions.py` ìˆ˜ì •:

```python
# ê¸°ì¡´
self.adaptive_crisis_gain_sharpe = 0.25  # âŒ

# ìˆ˜ì •
self.adaptive_crisis_gain_sharpe = -0.15  # âœ…
```

**íš¨ê³¼**:

- Îº(c) = 0.20 - 0.15\*c
- í‰ì‹œ: Îº=0.20 (Sharpe ì¶”êµ¬)
- ìœ„ê¸°: Îº=0.05 (ìƒì¡´ ìš°ì„ )
- T-Cellê³¼ Reward ì¼ì¹˜ â†’ Î± ë„“ì€ ë²”ìœ„ í™œìš©

---

## 11. ì°¸ê³  ë¬¸í—Œ

### 11.1 ì´ë¡ ì  ê¸°ì´ˆ

1. **Cuturi, M. (2013)**. "Sinkhorn Distances: Lightspeed Computation of Optimal Transport". _NIPS 2013_.

   - IRTì˜ Optimal Transport ë©”ì»¤ë‹ˆì¦˜ ê¸°ë°˜

2. **Hofbauer, J., & Sigmund, K. (1998)**. "Evolutionary Games and Population Dynamics". _Cambridge University Press_.

   - IRTì˜ Replicator Dynamics ì´ë¡ ì  ê·¼ê±°

3. **Amari, S. (2016)**. "Information Geometry and Its Applications". _Applied Mathematical Sciences_.
   - Dirichlet ë¶„í¬ ë° ì •ë³´ê¸°í•˜í•™

### 11.2 ê°•í™”í•™ìŠµ í”„ë ˆì„ì›Œí¬

4. **Liu, X. Y., et al. (2024)**. "FinRL: Financial Reinforcement Learning Framework". _NeurIPS Workshop_.

   - IRT í†µí•© í¬íŠ¸í´ë¦¬ì˜¤ í™˜ê²½

5. **Raffin, A., et al. (2021)**. "Stable-Baselines3: Reliable Reinforcement Learning Implementations". _JMLR_.
   - SAC ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„ ê¸°ë°˜

### 11.3 ê¸ˆìœµ ì‘ìš©

6. **Markowitz, H. (1952)**. "Portfolio Selection". _Journal of Finance_.

   - í˜„ëŒ€ í¬íŠ¸í´ë¦¬ì˜¤ ì´ë¡ 

7. **Rockafellar, R. T., & Uryasev, S. (2000)**. "Optimization of conditional value-at-risk". _Journal of Risk_.
   - CVaR ê°œë…

### 11.4 ë©´ì—­í•™

8. **Janeway, C. A., et al. (2001)**. "Immunobiology". _Garland Science_.
   - ì ì‘ ë©´ì—­ê³„ ë©”ì»¤ë‹ˆì¦˜

### 11.5 ì¶”ê°€ ìë£Œ

- **í”„ë¡œì íŠ¸ README**: [../README.md](../README.md)
- **ë³€ê²½ì‚¬í•­ ì´ë ¥**: [CHANGELOG.md](CHANGELOG.md)
- **ìŠ¤í¬ë¦½íŠ¸ ê°€ì´ë“œ**: [SCRIPTS.md](SCRIPTS.md)
- **FinRL ê³µì‹ ë¬¸ì„œ**: https://finrl.readthedocs.io/
- **Stable Baselines3 ë¬¸ì„œ**: https://stable-baselines3.readthedocs.io/

---

## 12. ë¶€ë¡

### 12.1 ì½”ë“œ ë§¤í•‘

| ê¸°ëŠ¥           | íŒŒì¼                                               | ì£¼ìš” í´ë˜ìŠ¤/í•¨ìˆ˜               |
| -------------- | -------------------------------------------------- | ------------------------------ |
| **IRT ì •ì±…**   | `finrl/agents/irt/irt_policy.py`                   | `IRTPolicy`, `IRTActorWrapper` |
| **IRT Actor**  | `finrl/agents/irt/bcell_actor.py`                  | `BCellIRTActor`                |
| **IRT ì—°ì‚°ì** | `finrl/agents/irt/irt_operator.py`                 | `IRT`, `_cost_matrix()`        |
| **ìœ„ê¸° ê°ì§€**  | `finrl/agents/irt/t_cell.py`                       | `TCellMinimal`                 |
| **í™˜ê²½**       | `finrl/meta/env_stock_trading/env_stocktrading.py` | `StockTradingEnv`              |
| **ë³´ìƒ í•¨ìˆ˜**  | `finrl/meta/env_stock_trading/reward_functions.py` | `RiskSensitiveReward`          |
| **í•™ìŠµ**       | `scripts/train_irt.py`                             | `main()`                       |
| **í‰ê°€**       | `scripts/evaluate.py`                              | `evaluate_model()`             |
| **ë¹„êµ**       | `scripts/compare_models.py`                        | `compare_models()`             |
| **í…ŒìŠ¤íŠ¸**     | `tests/test_irt_policy.py`                         | `test_*`                       |

### 12.2 ìš©ì–´ ëŒ€ì¡°í‘œ

| ë…¼ë¬¸ ìš©ì–´ (Formal)   | ì½”ë“œë² ì´ìŠ¤ ìš©ì–´ (Metaphorical) | ìœ„ì¹˜              |
| -------------------- | ------------------------------ | ----------------- |
| Crisis Detector      | T-Cell Network                 | `t_cell.py`       |
| State Encoder        | Epitope Encoder                | `bcell_actor.py`  |
| Expert Strategies    | Prototype Keys                 | `bcell_actor.py`  |
| Expert Policy Heads  | Decoders                       | `bcell_actor.py`  |
| Q-values             | Fitness                        | `irt_policy.py`   |
| State Representation | Epitope Tokens                 | `bcell_actor.py`  |
| Crisis Embedding     | Danger Embedding               | `bcell_actor.py`  |
| Expert Weights       | Prototype Weights              | `irt_operator.py` |
| Distance Matrix      | Immunological Cost Matrix      | `irt_operator.py` |

### 12.3 í™˜ê²½ ë³€ìˆ˜

**ì„ íƒì  í™˜ê²½ ë³€ìˆ˜**:

```bash
export CUDA_VISIBLE_DEVICES=0  # GPU ì„ íƒ
export OMP_NUM_THREADS=8       # CPU ìŠ¤ë ˆë“œ ìˆ˜
export FINRL_DATA_DIR=./data   # ë°ì´í„° ë””ë ‰í† ë¦¬
```

### 12.4 ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
FinFlow-rl/
â”œâ”€â”€ finrl/
â”‚   â”œâ”€â”€ agents/
â”‚   â”‚   â””â”€â”€ irt/
â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚       â”œâ”€â”€ irt_policy.py      # IRTPolicy, IRTActorWrapper
â”‚   â”‚       â”œâ”€â”€ bcell_actor.py     # BCellIRTActor (í•µì‹¬ êµ¬í˜„)
â”‚   â”‚       â”œâ”€â”€ irt_operator.py    # IRT Operator (OT + Rep)
â”‚   â”‚       â””â”€â”€ t_cell.py          # TCellMinimal (ìœ„ê¸° ê°ì§€)
â”‚   â”œâ”€â”€ meta/
â”‚   â”‚   â”œâ”€â”€ env_stock_trading/
â”‚   â”‚   â”‚   â”œâ”€â”€ env_stocktrading.py
â”‚   â”‚   â”‚   â””â”€â”€ reward_functions.py
â”‚   â”‚   â””â”€â”€ preprocessor/
â”‚   â””â”€â”€ evaluation/
â”‚       â”œâ”€â”€ metrics.py
â”‚       â””â”€â”€ visualizer.py
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ train_irt.py               # í•™ìŠµ ìŠ¤í¬ë¦½íŠ¸
â”‚   â”œâ”€â”€ evaluate.py                # í‰ê°€ ìŠ¤í¬ë¦½íŠ¸
â”‚   â”œâ”€â”€ compare_models.py          # ëª¨ë¸ ë¹„êµ
â”‚   â””â”€â”€ visualize_from_json.py     # ì‹œê°í™”
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ test_irt_policy.py         # ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
â”‚   â””â”€â”€ phase_gate.py              # Phase gate ê²€ì¦
â”œâ”€â”€ logs/
â”‚   â””â”€â”€ irt/
â”‚       â””â”€â”€ <timestamp>/
â”‚           â”œâ”€â”€ irt_final.zip      # ìµœì¢… ëª¨ë¸
â”‚           â”œâ”€â”€ best_model.zip     # ìµœê³  ì„±ëŠ¥ ëª¨ë¸
â”‚           â”œâ”€â”€ tensorboard/       # TensorBoard ë¡œê·¸
â”‚           â””â”€â”€ env_meta.json      # í™˜ê²½ ë©”íƒ€ë°ì´í„°
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ IRT.md                     # ë³¸ ë¬¸ì„œ
â”‚   â”œâ”€â”€ CHANGELOG.md
â”‚   â””â”€â”€ SCRIPTS.md
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ setup.py
â””â”€â”€ README.md
```

### 12.5 ìµœì†Œ ë™ì‘ ì˜ˆì‹œ

**í•™ìŠµ**:

```bash
python scripts/train_irt.py --mode train --episodes 60 --reward-type adaptive_risk
```

**í‰ê°€**:

```bash
python scripts/evaluate.py \
  --model logs/irt/<timestamp>/irt_final.zip \
  --method direct \
  --viz all \
  --xai-level full
```

**ì‹œê°í™”**:

```bash
python scripts/visualize_from_json.py \
  --input-dir logs/irt/<timestamp>/evaluation_results \
  --html-index
```

### 12.6 ë¼ì´ì„¼ìŠ¤ ë° ì¸ìš©

**ë¼ì´ì„¼ìŠ¤**: MIT License

**ì¸ìš©**:

```bibtex
@misc{finrl-irt-2025,
  title={IRT: Immune Replicator Transport for Crisis-Adaptive Portfolio Management},
  author={FinRL-IRT Team},
  year={2025},
  howpublished={\url{https://github.com/reo91004/FinFlow-rl}}
}
```

---

**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2025-10-16
**ë²„ì „**: 1.0.0
**ë¬¸ì˜**: GitHub Issues ë˜ëŠ” Discussions
