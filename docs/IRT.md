# IRT (Immune Replicator Transport) ì„¤ëª…ì„œ

## ğŸ“‹ ëª©ì°¨

1. [ê°œìš”](#ê°œìš”)
2. [ë‚´ë¶€ ì•„í‚¤í…ì²˜](#ë‚´ë¶€-ì•„í‚¤í…ì²˜)
3. [IRTì˜ í•µì‹¬ ë©”ì»¤ë‹ˆì¦˜](#irtì˜-í•µì‹¬-ë©”ì»¤ë‹ˆì¦˜)
4. [ìœ„ê¸° ê°ì§€ ì‹œìŠ¤í…œ](#ìœ„ê¸°-ê°ì§€-ì‹œìŠ¤í…œ)
5. [ì ì‘í˜• ë©”ì»¤ë‹ˆì¦˜](#ì ì‘í˜•-ë©”ì»¤ë‹ˆì¦˜)
6. [í”„ë¡œí† íƒ€ì… í•™ìŠµ](#í”„ë¡œí† íƒ€ì…-í•™ìŠµ)
7. [ë‹¤ë¥¸ ì•Œê³ ë¦¬ì¦˜ê³¼ì˜ ë¹„êµ](#ë‹¤ë¥¸-ì•Œê³ ë¦¬ì¦˜ê³¼ì˜-ë¹„êµ)
8. [í•˜ì´í¼íŒŒë¼ë¯¸í„° ê°€ì´ë“œ](#í•˜ì´í¼íŒŒë¼ë¯¸í„°-ê°€ì´ë“œ)
9. [ì‚¬ìš© ì˜ˆì‹œ](#ì‚¬ìš©-ì˜ˆì‹œ)
10. [ì°¸ê³  ë¬¸í—Œ](#ì°¸ê³ -ë¬¸í—Œ)
11. [ì„±ëŠ¥ ëª©í‘œ ë° ê¸°ëŒ€ íš¨ê³¼](#ì„±ëŠ¥-ëª©í‘œ-ë°-ê¸°ëŒ€-íš¨ê³¼)

---

## ê°œìš”

### IRTë€ ë¬´ì—‡ì¸ê°€?

IRT (Immune Replicator Transport)ëŠ” **ë©´ì—­í•™ì  ë©”ì»¤ë‹ˆì¦˜ì—ì„œ ì˜ê°ì„ ë°›ì€** ìœ„ê¸° ì ì‘í˜• í¬íŠ¸í´ë¦¬ì˜¤ ê´€ë¦¬ ì•Œê³ ë¦¬ì¦˜ì´ë‹¤. ê¸ˆìœµ ì‹œì¥ì˜ ì •ìƒ êµ¬ê°„ê³¼ ìœ„ê¸° êµ¬ê°„ì—ì„œ ì„œë¡œ ë‹¤ë¥¸ ìµœì  ì „ëµì´ í•„ìš”í•˜ë‹¤ëŠ” ì¸ì‚¬ì´íŠ¸ë¥¼ ë°”íƒ•ìœ¼ë¡œ, ì„¸ ê°€ì§€ í•µì‹¬ ë©”ì»¤ë‹ˆì¦˜ì„ ê²°í•©í•œë‹¤:

1. **Optimal Transport (OT)**: í˜„ì¬ ì‹œì¥ ìƒíƒœì™€ ì „ë¬¸ê°€ ì „ëµ ê°„ì˜ êµ¬ì¡°ì  ë§¤ì¹­
2. **Replicator Dynamics**: ê³¼ê±° ì„±ê³µ ì „ëµì— ëŒ€í•œ ì‹œê°„ ë©”ëª¨ë¦¬
3. **T-Cell Crisis Detection**: ë‹¤ì¤‘ ì‹ í˜¸ ê¸°ë°˜ ì‹¤ì‹œê°„ ìœ„ê¸° ê°ì§€

### í•µì‹¬ ê³µì‹

```
w_t = (1-Î±_c)Â·Replicator(w_{t-1}, f_t) + Î±_cÂ·Transport(E_t, K, C_t)
```

**ì£¼ìš” íŠ¹ì§•**:

- `Î±_c`: **ë™ì  í˜¼í•© ë¹„ìœ¨** - ìœ„ê¸° ìƒí™©ì— ë”°ë¼ ìë™ ì¡°ì ˆ
  - í‰ì‹œ(câ‰ˆ0): Î±_c â‰ˆ Î±_max (OT ì¦ê°€, íƒìƒ‰ì  ë§¤ì¹­)
  - ìœ„ê¸°(câ‰ˆ1): Î±_c â‰ˆ Î±_min (Replicator ì¦ê°€, ê²€ì¦ëœ ì „ëµ ì„ í˜¸)
- `w_t`: í”„ë¡œí† íƒ€ì… í˜¼í•© ê°€ì¤‘ì¹˜ [B, M]
- `f_t`: Critic Q-value ê¸°ë°˜ í”„ë¡œí† íƒ€ì… ì í•©ë„ [B, M]
- `E_t`: ì—í”¼í† í”„(ìƒíƒœ ì¸ì½”ë”©) [B, m, D]
- `K`: í•™ìŠµ ê°€ëŠ¥í•œ í”„ë¡œí† íƒ€ì… í‚¤ [M, D]

### ì™œ ìœ„ê¸° ì ì‘ì— íš¨ê³¼ì ì¸ê°€?

ì¼ë°˜ì ì¸ ê°•í™”í•™ìŠµ ì•Œê³ ë¦¬ì¦˜ì€ **ë‹¨ì¼ ì •ì±…**ì„ í•™ìŠµí•œë‹¤. í•˜ì§€ë§Œ ê¸ˆìœµ ì‹œì¥ì€ **ì •ìƒ êµ¬ê°„**ê³¼ **ìœ„ê¸° êµ¬ê°„**ì—ì„œ ì™„ì „íˆ ë‹¤ë¥¸ íŠ¹ì„±ì„ ë³´ì¸ë‹¤:

- **ì •ìƒ êµ¬ê°„**: ë‚®ì€ ë³€ë™ì„±, ì˜ˆì¸¡ ê°€ëŠ¥í•œ íŒ¨í„´, ë¶„ì‚° íˆ¬ì ìœ ë¦¬
- **ìœ„ê¸° êµ¬ê°„**: ë†’ì€ ë³€ë™ì„±, ê¸‰ê²©í•œ ë³€í™”, ìƒê´€ê´€ê³„ ë¶•ê´´, ë°©ì–´ì  ì „ëµ í•„ìš”

IRTëŠ” **Mê°œì˜ ì „ë¬¸ê°€ í”„ë¡œí† íƒ€ì…**ì„ í•™ìŠµí•˜ê³ , í˜„ì¬ ìƒí™©ì— ë”°ë¼ ë™ì ìœ¼ë¡œ í˜¼í•©í•œë‹¤:

```
ì‹œì¥ ê´€ì°° â†’ T-Cell ë‹¤ì¤‘ ì‹ í˜¸ ìœ„ê¸° ê°ì§€ (ì‹œì¥ í†µê³„ + DSR + CVaR)
         â†’ ìœ„ê¸° ë ˆë²¨ ì‚°ì¶œ (ë°”ì´ì–´ìŠ¤ ë³´ì • + íˆìŠ¤í…Œë¦¬ì‹œìŠ¤)
         â†’ Î±_c ë™ì  ì¡°ì ˆ (ìœ„ê¸° ì‹œ Replicator ê°€ì¤‘)
         â†’ Î· ê°€ì—´ (ë¹ ë¥¸ ì ì‘)
         â†’ OT ë¹„ìš© í•¨ìˆ˜ ì¡°ì • (ë©´ì—­í•™ì  ì‹ í˜¸)
         â†’ ìµœì  í”„ë¡œí† íƒ€ì… í˜¼í•© ì„ íƒ
         â†’ ìœ„ê¸° ì ì‘í˜• í¬íŠ¸í´ë¦¬ì˜¤ êµ¬ì„±
```

---

## ë‚´ë¶€ ì•„í‚¤í…ì²˜

### ì „ì²´ ì‹œìŠ¤í…œ êµ¬ì¡°

IRTëŠ” Stable Baselines3ì˜ SAC ì•Œê³ ë¦¬ì¦˜ê³¼ ì™„ì „íˆ í†µí•©ë˜ì–´ ì‘ë™í•œë‹¤. SACì˜ Critic (Q-network)ì„ ì¬ì‚¬ìš©í•˜ê³  Actorë§Œ IRTë¡œ êµì²´í•˜ëŠ” êµ¬ì¡°ë‹¤.

#### ê³ ìˆ˜ì¤€ ì•„í‚¤í…ì²˜ (High-Level Architecture)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          SAC Training Framework                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚    Replay    â”‚â”€â”€â”€â”€â”€â”€â”€â”€>â”‚   IRT Policy    â”‚<â”€â”€â”€â”€â”€â”€â”‚ Twin Critics â”‚ â”‚
â”‚  â”‚    Buffer    â”‚         â”‚   (Ï€_Î¸)         â”‚       â”‚   (Q_Ï†1, Q_Ï†2)â”‚ â”‚
â”‚  â”‚              â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚       â”‚              â”‚ â”‚
â”‚  â”‚  (s,a,r,s')  â”‚  store  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚                       â”‚         â”‚
â”‚                                    â”‚ Q-values [B,M]        â”‚         â”‚
â”‚                                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                    â”‚ Q(s,Ï€_j(s))                     â”‚
â”‚                                    â–¼                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                      IRT Actor Network                          â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚  Input: s_t âˆˆ â„^d                                              â”‚ â”‚
â”‚  â”‚  Output: a_t âˆˆ Î”^n (Simplex)                                   â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚   Crisis    â”‚    â”‚  State       â”‚    â”‚   Expert         â”‚  â”‚ â”‚
â”‚  â”‚  â”‚   Detector  â”‚â”€â”€â”€>â”‚  Encoder     â”‚    â”‚   Strategies     â”‚  â”‚ â”‚
â”‚  â”‚  â”‚             â”‚    â”‚  (Ï•_s)       â”‚    â”‚   {Î¸_j}^M_j=1    â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ c_t, h^c_t  â”‚    â”‚  h^s_t       â”‚â”€â”€â”€>â”‚  IRT Operator    â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  (Î¨_IRT)         â”‚  â”‚ â”‚
â”‚  â”‚                                          â”‚                  â”‚  â”‚ â”‚
â”‚  â”‚  Q-values Q_t â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> w_t = Î¨_IRT()   â”‚  â”‚ â”‚
â”‚  â”‚  [M]                                     â”‚  [M]             â”‚  â”‚ â”‚
â”‚  â”‚                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                                                   â”‚             â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚           Mixture Policy (Ï•_Ï€)                            â”‚ â”‚ â”‚
â”‚  â”‚  â”‚                                                            â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  Î±_j = MLP_j(Î¸_j)  [n]                                    â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  Î±_t = Î£_j w_{t,j} Â· Î±_j  [n]                             â”‚ â”‚ â”‚
â”‚  â”‚  â”‚                                                            â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  a_t ~ Dir(Î±_t)  or  a_t = softmax(Î±_t/Ï„)                â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                    â”‚                                 â”‚
â”‚                                    â–¼                                 â”‚
â”‚                          Environment (s', r)                         â”‚
â”‚                                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### IRT Actor ìƒì„¸ ì•„í‚¤í…ì²˜ (Detailed IRT Actor Architecture)

```
                    Input State s_t âˆˆ â„^d  (d=181)
                           â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚                    â”‚                    â”‚
      â–¼                    â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Market     â”‚    â”‚   State      â”‚    â”‚  Q-value        â”‚
â”‚  Features   â”‚    â”‚   Features   â”‚    â”‚  Estimation     â”‚
â”‚  Extraction â”‚    â”‚              â”‚    â”‚  (Twin Critics) â”‚
â”‚             â”‚    â”‚              â”‚    â”‚                 â”‚
â”‚  x^m âˆˆ â„^12 â”‚    â”‚  s_t âˆˆ â„^d   â”‚    â”‚  Q_j=Q(s,Ï€_j(s))â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                  â”‚                     â”‚
       â”‚                  â”‚                     â”‚ Q âˆˆ â„^M
       â–¼                  â–¼                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  Crisis      â”‚   â”‚  State      â”‚             â”‚
â”‚  Detector    â”‚   â”‚  Encoder    â”‚             â”‚
â”‚  (Ï•_c)       â”‚   â”‚  (Ï•_s)      â”‚             â”‚
â”‚              â”‚   â”‚             â”‚             â”‚
â”‚  h = MLP(x^m)â”‚   â”‚  h = MLP(s) â”‚             â”‚
â”‚  z, h^c = h  â”‚   â”‚  h^s = h    â”‚             â”‚
â”‚              â”‚   â”‚  [mÃ—D]      â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜             â”‚
       â”‚                  â”‚                     â”‚
       â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
       â”‚ â”‚                                      â”‚
       â–¼ â–¼                                      â”‚
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
  â”‚    Multi-Signal Crisis Assessment   â”‚       â”‚
  â”‚    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚       â”‚
  â”‚                                     â”‚       â”‚
  â”‚  Signal Extraction:                â”‚       â”‚
  â”‚    - Market signal: z [4]          â”‚       â”‚
  â”‚    - Sharpe gradient: Î”s           â”‚       â”‚
  â”‚    - CVaR signal: c_v              â”‚       â”‚
  â”‚                                     â”‚       â”‚
  â”‚  Z-Score Normalization:            â”‚       â”‚
  â”‚    z_i = (x_i - Î¼_i)/Ïƒ_i  (EMA)   â”‚       â”‚
  â”‚                                     â”‚       â”‚
  â”‚  Weighted Fusion:                  â”‚       â”‚
  â”‚    c_r = w_mÂ·Ïƒ(k_mÂ·z_m)            â”‚       â”‚
  â”‚        + w_sÂ·Ïƒ(k_sÂ·z_s)            â”‚       â”‚
  â”‚        + w_cÂ·Ïƒ(k_cÂ·z_c)            â”‚       â”‚
  â”‚                                     â”‚       â”‚
  â”‚  Bias/Temperature Correction:      â”‚       â”‚
  â”‚    cÌƒ = Ïƒ((c_r - b)/T)              â”‚       â”‚
  â”‚                                     â”‚       â”‚
  â”‚  Target-Driven Regularization:     â”‚       â”‚
  â”‚    c = cÌƒ + Î»_gÂ·(c_target - cÌƒ)     â”‚       â”‚
  â”‚                                     â”‚       â”‚
  â”‚  Output: c_t âˆˆ [0,1], h^c_t âˆˆ â„^D  â”‚       â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
                   â”‚                            â”‚
                   â”‚                            â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚          IRT Operator (Î¨_IRT)                  â”‚
  â”‚          â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                  â”‚
  â”‚                                                â”‚
  â”‚  Input:  h^s_t [mÃ—D], {Î¸_j} [MÃ—D], h^c_t [D], â”‚
  â”‚          w_{t-1} [M], Q_t [M], c_t, Î”s_t      â”‚
  â”‚                                                â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
  â”‚  â”‚ Optimal          â”‚  â”‚ Replicator         â”‚ â”‚
  â”‚  â”‚ Transport        â”‚  â”‚ Dynamics           â”‚ â”‚
  â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€        â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€           â”‚ â”‚
  â”‚  â”‚                  â”‚  â”‚                    â”‚ â”‚
  â”‚  â”‚ Distance Matrix: â”‚  â”‚ Adaptive LR:       â”‚ â”‚
  â”‚  â”‚  C = d_M(h^s,Î¸)  â”‚  â”‚  Î· = Î·_0+Î·_1Â·c    â”‚ â”‚
  â”‚  â”‚    - Î³âŸ¨h^s,h^câŸ©  â”‚  â”‚                    â”‚ â”‚
  â”‚  â”‚    + penalties   â”‚  â”‚ Advantage:         â”‚ â”‚
  â”‚  â”‚                  â”‚  â”‚  A = Q - w^T Q    â”‚ â”‚
  â”‚  â”‚ Sinkhorn OT:     â”‚  â”‚                    â”‚ â”‚
  â”‚  â”‚  P* = S(C,Îµ)     â”‚  â”‚ Update:            â”‚ â”‚
  â”‚  â”‚                  â”‚  â”‚  wÌƒ âˆ wÂ·exp(Î·Â·A)   â”‚ â”‚
  â”‚  â”‚ Marginal:        â”‚  â”‚  w_r=softmax(wÌƒ/Ï„) â”‚ â”‚
  â”‚  â”‚  w_o = P*^T 1_m  â”‚  â”‚                    â”‚ â”‚
  â”‚  â”‚                  â”‚  â”‚                    â”‚ â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
  â”‚           â”‚                      â”‚            â”‚
  â”‚           â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
  â”‚           â”‚  â”‚                                â”‚
  â”‚           â–¼  â–¼                                â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
  â”‚  â”‚  Dynamic Î± Schedule    â”‚                   â”‚
  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚                   â”‚
  â”‚  â”‚                        â”‚                   â”‚
  â”‚  â”‚  Î±(c) = Î±_max + ...    â”‚                   â”‚
  â”‚  â”‚  Î±'(Î”s) = Î±Â·(1+...)    â”‚                   â”‚
  â”‚  â”‚                        â”‚                   â”‚
  â”‚  â”‚  w_t = (1-Î±')Â·w_r      â”‚                   â”‚
  â”‚  â”‚      + Î±'Â·w_o          â”‚                   â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
  â”‚                                                â”‚
  â”‚  Output: w_t âˆˆ Î”^M (Expert weights)           â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ w_t [M]
                         â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚         Mixture Policy Network (Ï•_Ï€)           â”‚
  â”‚         â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€           â”‚
  â”‚                                                â”‚
  â”‚  Expert Policy Heads: {MLP_j}^M_j=1           â”‚
  â”‚                                                â”‚
  â”‚  âˆ€j: Î±_j = MLP_j(Î¸_j) âˆˆ â„^n                   â”‚
  â”‚       Î±_j = clamp(tanh(Â·)Â·7.5+2.5, 0.01)      â”‚
  â”‚                                                â”‚
  â”‚  Weighted Aggregation:                        â”‚
  â”‚    Î±_t = Î£^M_j=1 w_{t,j} Â· Î±_j               â”‚
  â”‚                                                â”‚
  â”‚  Action Sampling:                             â”‚
  â”‚    Training:   a_t ~ Dirichlet(Î±_t)           â”‚
  â”‚    Inference:  a_t = softmax(Î±_t/Ï„_a)         â”‚
  â”‚                                                â”‚
  â”‚  Simplex Projection: a_t âˆˆ Î”^n               â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
                    Output Action a_t âˆˆ Î”^n  (n=30)
                    Portfolio Weights
```

#### ë°ì´í„° í”Œë¡œìš° ë° ì°¨ì›

| ëª¨ë“ˆ | ì…ë ¥ | ì¶œë ¥ | ì„¤ëª… |
|------|------|------|------|
| **Market Features** | s_t [d] | x^m [12] | ì‹œì¥ í†µê³„ + ê¸°ìˆ  ì§€í‘œ |
| **Crisis Detector (Ï•_c)** | x^m [12] | z [4], h^c [D] | ìœ„ê¸° ì‹ í˜¸ ë²¡í„°, ìœ„ê¸° ì„ë² ë”© |
| **Multi-Signal Assessment** | z, Î”s, c_v | c [1] | ë‹¤ì¤‘ ì‹ í˜¸ ìœµí•© â†’ ìœ„ê¸° ë ˆë²¨ |
| **State Encoder (Ï•_s)** | s_t [d] | h^s [mÃ—D] | ìƒíƒœ â†’ ë‹¤ì¤‘ í‘œí˜„ í† í° |
| **Expert Strategies** | - | {Î¸_j} [MÃ—D] | í•™ìŠµ ê°€ëŠ¥í•œ ì „ë¬¸ê°€ íŒŒë¼ë¯¸í„° |
| **Q-value Estimation** | s_t, {Î¸_j} | Q [M] | Twin Critic Q-networks |
| **IRT Operator (Î¨_IRT)** | h^s, {Î¸_j}, h^c, w_prev, Q, c, Î”s | w [M] | OT + Replicator ê²°í•© |
| **Expert Policy Heads {MLP_j}** | Î¸_j [D] | Î±_j [n] | ì „ë¬¸ê°€ â†’ Concentration |
| **Mixture Policy (Ï•_Ï€)** | w [M], {Î±_j} [MÃ—n] | a_t [n] | ìµœì¢… í¬íŠ¸í´ë¦¬ì˜¤ |

**í‘œê¸°ë²•**:
- d: ìƒíƒœ ì°¨ì› (181)
- n: í–‰ë™ ì°¨ì› (30, ìì‚° ìˆ˜)
- m: ìƒíƒœ í‘œí˜„ í† í° ìˆ˜ (6)
- M: ì „ë¬¸ê°€ ìˆ˜ (8)
- D: ì„ë² ë”© ì°¨ì› (128)
- Î”^k: k-simplex (í•©ì´ 1ì¸ ì–‘ìˆ˜ ë²¡í„°)
- [k]: k-ì°¨ì› ë²¡í„°
- [kÃ—l]: kÃ—l í–‰ë ¬

---

### ìš©ì–´ ë§¤í•‘: ë…¼ë¬¸ â†” ì½”ë“œë² ì´ìŠ¤

ë³¸ ë¬¸ì„œì—ì„œëŠ” ë…¼ë¬¸ ì‘ì„±ì„ ìœ„í•´ formalí•œ ìš©ì–´ë¥¼ ì‚¬ìš©í•˜ì§€ë§Œ, ì‹¤ì œ ì½”ë“œë² ì´ìŠ¤ì—ì„œëŠ” ë©´ì—­í•™ì  ë¹„ìœ ë¥¼ ì‚¬ìš©í•œë‹¤. ë‹¤ìŒì€ ìš©ì–´ ë§¤í•‘í‘œë‹¤:

| ë…¼ë¬¸ ìš©ì–´ (Formal) | ì½”ë“œë² ì´ìŠ¤ ìš©ì–´ (Metaphorical) | êµ¬í˜„ ìœ„ì¹˜ |
|-------------------|-------------------------------|----------|
| **IRT Operator** | IRT Operator | `finrl/agents/irt/irt_operator.py` |
| **Crisis Detector (Ï•_c)** | T-Cell Network | `finrl/agents/irt/t_cell.py:TCellMinimal` |
| **State Encoder (Ï•_s)** | Epitope Encoder | `finrl/agents/irt/bcell_actor.py:epitope_encoder` |
| **Expert Strategies {Î¸_j}** | Prototype Keys | `finrl/agents/irt/bcell_actor.py:proto_keys` |
| **Expert Policy Heads {MLP_j}** | Decoders | `finrl/agents/irt/bcell_actor.py:decoders` |
| **Q-values (Q_t)** | Fitness | `finrl/agents/irt/irt_policy.py:_compute_fitness()` |
| **State Representation (h^s)** | Epitope Tokens (E) | `bcell_actor.py:L439` |
| **Crisis Embedding (h^c)** | Danger Embedding | `bcell_actor.py:L324` |
| **Expert Weights (w_t)** | Prototype Weights | `irt_operator.py:L312` |
| **Distance Matrix (C)** | Immunological Cost Matrix | `irt_operator.py:L171-222` |
| **Multi-Signal Assessment** | T-Cell Multi-Signal Detection | `bcell_actor.py:L292-434` |
| **Z-Score Normalization** | EMA Statistics | `bcell_actor.py:L331-347` |
| **Bias/Temperature Correction** | Crisis Bias/Temperature | `bcell_actor.py:L389-407` |
| **Target-Driven Regularization** | T-Cell Guard | `bcell_actor.py:L409-415` |
| **Mixture Policy (Ï•_Ï€)** | Dirichlet Mixture Policy | `bcell_actor.py:L466-498` |
| **Adaptive Learning Rate (Î·)** | Crisis Heating | `irt_operator.py:L265-267` |
| **Dynamic Î± Schedule** | Dynamic OT-Replicator Mixing | `irt_operator.py:L288-303` |

**ì£¼ìš” ìš©ì–´ ì„¤ëª…**:

1. **Crisis Detector â†’ T-Cell**
   - ë…¼ë¬¸: ìœ„ê¸° ê°ì§€ ì‹ ê²½ë§
   - ì½”ë“œ: T-Cell (ë©´ì—­ ì„¸í¬ì˜ ë¹„ìœ )
   - ì´ìœ : ë©´ì—­ê³„ì˜ T-Cellì´ ë³‘ì›ì²´ë¥¼ ê°ì§€í•˜ëŠ” ê²ƒì²˜ëŸ¼ ì‹œì¥ ìœ„ê¸°ë¥¼ ê°ì§€

2. **State Encoder â†’ Epitope Encoder**
   - ë…¼ë¬¸: ìƒíƒœë¥¼ ë‹¤ì¤‘ í† í°ìœ¼ë¡œ ì¸ì½”ë”©
   - ì½”ë“œ: Epitope (í•­ì› ê²°ì •ê¸°ì˜ ë¹„ìœ )
   - ì´ìœ : ë©´ì—­ê³„ì˜ í•­ì›-í•­ì²´ ê²°í•©ì²˜ëŸ¼ ìƒíƒœ-ì „ëµ ë§¤ì¹­

3. **Expert Strategies â†’ Prototypes**
   - ë…¼ë¬¸: í•™ìŠµ ê°€ëŠ¥í•œ ì „ë¬¸ê°€ ì „ëµ íŒŒë¼ë¯¸í„°
   - ì½”ë“œ: Prototype Keys (ì›í˜•ì˜ ë¹„ìœ )
   - ì´ìœ : ê° ì „ë¬¸ê°€ê°€ íŠ¹ì • ì‹œì¥ ì¡°ê±´ì˜ í”„ë¡œí† íƒ€ì… ì „ëµ

4. **Q-values â†’ Fitness**
   - ë…¼ë¬¸: Criticì˜ Q-value ì¶”ì •
   - ì½”ë“œ: Fitness (ì§„í™”ë¡ ì  ì í•©ë„)
   - ì´ìœ : Replicator Dynamicsê°€ ì§„í™” ê²Œì„ ì´ë¡ ì—ì„œ ìœ ë˜

5. **Distance Matrix â†’ Immunological Cost**
   - ë…¼ë¬¸: ìƒíƒœ-ì „ëµ ê°„ ê±°ë¦¬ í–‰ë ¬
   - ì½”ë“œ: Immunological Cost (ë©´ì—­í•™ì  ë¹„ìš©)
   - ì´ìœ : ë©´ì—­ ë°˜ì‘ì˜ ë¹„ìš© ê°œë…ì„ OT ë¹„ìš©ìœ¼ë¡œ í•´ì„

**ì½”ë“œ ì˜ˆì‹œ**:

```python
# ë…¼ë¬¸: Crisis Detector
# ì½”ë“œ: T-Cell Network
self.t_cell = TCellMinimal(in_dim=market_feature_dim, emb_dim=emb_dim)
# ìœ„ì¹˜: bcell_actor.py:196-199

# ë…¼ë¬¸: State Encoder
# ì½”ë“œ: Epitope Encoder
self.epitope_encoder = nn.Sequential(...)
# ìœ„ì¹˜: bcell_actor.py:147-153

# ë…¼ë¬¸: Expert Strategies
# ì½”ë“œ: Prototype Keys
self.proto_keys = nn.Parameter(torch.randn(M_proto, emb_dim))
# ìœ„ì¹˜: bcell_actor.py:156-159

# ë…¼ë¬¸: Q-values
# ì½”ë“œ: Fitness
fitness = self._compute_fitness(obs)
# ìœ„ì¹˜: irt_policy.py:154, 183

# ë…¼ë¬¸: IRT Operator
# ì½”ë“œ: IRT (ë™ì¼)
w, P, irt_debug = self.irt(E, K, danger_embed, w_prev, fitness, ...)
# ìœ„ì¹˜: bcell_actor.py:455-464
```

ì´ëŸ¬í•œ ë¹„ìœ ì  ëª…ëª…ì€ ì•Œê³ ë¦¬ì¦˜ì˜ ìƒë¬¼í•™ì  ì˜ê°ì„ ê°•ì¡°í•˜ê¸° ìœ„í•¨ì´ë‚˜, ë…¼ë¬¸ì—ì„œëŠ” formalí•œ ìš©ì–´ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ í‘œì¤€ì ì´ë‹¤.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                    SAC Training Loop                                     â”‚
â”‚                                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚  Replay Buffer   â”‚         â”‚      IRTPolicy (SACPolicy)         â”‚                   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                   â”‚
â”‚  â”‚  (s,a,r,s',d)    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”‚  Features Extractor          â”‚ â”‚                   â”‚
â”‚  â”‚  100k samples    â”‚  store  â”‚  â”‚  (FlattenExtractor)          â”‚ â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚  â”‚  state[181] â†’ features[181]  â”‚ â”‚                   â”‚
â”‚         â”‚                     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                   â”‚
â”‚         â”‚ sample batch        â”‚              â”‚                     â”‚                   â”‚
â”‚         â”‚ (256)               â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚         â–¼                     â”‚              â–¼                     â”‚              â”‚    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚              â”‚    â”‚
â”‚  â”‚ Train Step       â”‚         â”‚  â”‚   IRTActorWrapper (Actor)     â”‚ â”‚              â”‚    â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â”‚         â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚ â”‚              â”‚    â”‚
â”‚  â”‚ 1. Critic Update â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”‚                               â”‚ â”‚              â”‚    â”‚
â”‚  â”‚ 2. Actor Update  â”‚         â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚              â”‚    â”‚
â”‚  â”‚ 3. Target Update â”‚         â”‚  â”‚  â”‚ _compute_fitness(obs)   â”‚ â”‚ â”‚              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚  â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚ â”‚ â”‚              â”‚    â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚                         â”‚ â”‚ â”‚       â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
â”‚         â”‚                     â”‚  â”‚  â”‚  For j in M:           â”‚ â”‚ â”‚       â”‚  Twin Critic    â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚    conc_j = decoder_j()â”œâ”€â”¼â”€â”¼â”€â”€â”€â”€â”€â”€â”€â–º  Q-networks     â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚    a_j = softmax(conc) â”‚ â”‚ â”‚       â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚    fitness[j] = min(   â”œâ”€â”¼â”€â”¼â”€â”€â”€â”€â”€â”€â”€â–º  Q1(s,a), Q2(s,a)â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚      Q1(obs,a_j),      â”‚ â”‚ â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚         â”‚                     â”‚  â”‚  â”‚      Q2(obs,a_j))      â”‚ â”‚ â”‚              â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚                         â”‚ â”‚ â”‚              â”‚ Q-values
â”‚         â”‚                     â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚              â”‚
â”‚         â”‚                     â”‚  â”‚              â”‚                â”‚ â”‚              â”‚
â”‚         â”‚                     â”‚  â”‚              â–¼ fitness[B,M]   â”‚ â”‚              â”‚
â”‚         â”‚                     â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚              â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  BCellIRTActor.forward()â”‚ â”‚ â”‚              â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚ â”‚              â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  (state, fitness, det)  â”‚ â”‚ â”‚              â”‚
â”‚         â”‚                     â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚              â”‚
â”‚         â”‚                     â”‚  â”‚               â”‚              â”‚ â”‚              â”‚
â”‚         â”‚                     â”‚  â”‚               â–¼              â”‚ â”‚              â”‚
â”‚         â”‚                     â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚         IRT Core (6 Steps)               â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚         â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€               â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚                                          â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚ Step 1: T-Cell Crisis Detection    â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚                                    â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  Market Features (12-dim)          â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”œâ”€ balance, price_mean/std, ...   â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â””â”€ macd, boll, rsi, cci, ...      â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚                                    â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  TCellMinimal(market_feat)         â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚    â†’ crisis_affine, danger_embed   â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚                                    â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  DSR/CVaR Signals                  â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”œâ”€ delta_sharpe (state[-2])       â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â””â”€ cvar (state[-1])               â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚                                    â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  EMA Normalization (z-score)       â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”œâ”€ base_z, sharpe_z, cvar_z       â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚                                    â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  Multi-Signal Fusion               â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚    crisis_raw = w_rÂ·sigmoid(k_bÂ·z) â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚               + w_sÂ·sigmoid(-k_sÂ·z)â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚               + w_cÂ·sigmoid(k_cÂ·z) â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚                                    â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  Bias/Temperature Correction       â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚    affine = (raw - bias) / temp    â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚    crisis_pre = sigmoid(affine)    â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚                                    â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  T-Cell Guard                      â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚    crisis = pre + rateÂ·(0.5 - pre) â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚                                    â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  Hysteresis Regime                 â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚    â†’ crisis_level, crisis_regime   â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚                â”‚                        â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚                â–¼                        â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚ Step 2: Epitope Encoding           â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€               â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚                                    â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  epitope_encoder(state[181])       â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚    â†’ E [B, m=6, D=128]             â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚                                    â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  Multi-Token Representation:       â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  - Token 1~6: Different aspects    â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚    of market state                 â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚                â”‚                        â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚                â–¼                        â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚ Step 3: Prototype Keys             â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                 â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚                                    â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  proto_keys [M=8, D=128]           â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚    â†’ K [B, M=8, D=128]             â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚                                    â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  Learnable Expert Strategies:      â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  - Proto 0~7: Specialized for      â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚    different market conditions     â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚                â”‚                        â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚                â–¼                        â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚ Step 4: IRT Operator               â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                   â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚                                    â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  IRT(E, K, danger, w_prev,         â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚      fitness, crisis, delta_sharpe)â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚                                    â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚ [A] Optimal Transport Path   â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚                              â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚ Cost Matrix (Immunological): â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚   C = d_M(E,K)               â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚     - Î³Â·<E, danger>          â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚     + Î»Â·tolerance_penalty    â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚     + ÏÂ·checkpoint_penalty   â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚                              â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚ Sinkhorn Algorithm:          â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚   P* = argmin <P,C> + ÎµÂ·KL   â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚                              â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚ OT Margin:                   â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚   w_ot = Î£_i P*(i,j)         â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚          [B, M]              â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚                                    â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚ [B] Replicator Dynamics Path â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚                              â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚ Crisis Heating:              â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚   Î·(c) = Î·_0 + Î·_1Â·c         â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚                              â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚ Advantage:                   â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚   baseline = Î£ wÂ·fitness     â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚   A = fitness - baseline     â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚                              â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚ Replicator Equation:         â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚   log_wÌƒ = log(w_prev)        â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚          + Î·Â·A - r_penalty   â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚                              â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚ Temperature Softmax:         â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚   w_rep = softmax(log_wÌƒ/Ï„)   â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚           [B, M]             â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚                                    â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚ [C] Dynamic Mixing           â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€               â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚                              â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚ Dynamic Î±(c):                â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚   Î±_c = Î±_max + (Î±_min-Î±_max)â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚         Â·(1-cos(Ï€c))/2       â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚                              â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚ Sharpe Gradient Feedback:    â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚   Î±'= Î±Â·(1+0.6Â·tanh(Î”sharpe))â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚      + 0.07Â·tanh(Î”sharpe)    â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚   Î±_c = clamp(Î±', min, max)  â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚                              â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚ Fusion:                      â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚   w = (1-Î±_c)Â·w_rep          â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚     + Î±_cÂ·w_ot               â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â”‚       [B, M]                 â”‚ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚                                    â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  â†’ w, P, debug_info                â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚                â”‚                        â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚                â–¼                        â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚ Step 5: Dirichlet Mixing           â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€               â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚                                    â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  For each prototype j:             â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚    decoder_j(K[:,j,:])             â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚      â†’ conc_j [B, action_dim=30]   â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚                                    â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  Tanh â†’ Concentration:             â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚    conc = clamp(tanhÂ·7.5+2.5, 0.01)â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚                                    â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  IRT Weighted Mixing:              â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚    mixed_conc = Î£_j w_jÂ·conc_j     â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚                 [B, 30]            â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚                                    â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  if deterministic:                 â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚    action = softmax(conc/temp)     â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  else:                             â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚    action ~ Dirichlet(clamp(conc)) â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚                                    â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  Simplex Projection:               â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚    action = action / Î£_i action_i  â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚                â”‚                        â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚                â–¼                        â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚ Step 6: EMA Update                 â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                     â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚                                    â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚  if training:                      â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚    w_prev = Î²Â·w_prev               â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚           + (1-Î²)Â·w.mean(dim=0)    â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚                                    â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚    # Bias/Temperature adaptation   â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚    bias += Î·_bÂ·(p_hat - p_star)    â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â”‚    temp *= (1 + Î·_TÂ·(p_hat-p_star))â”‚ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â”‚                                          â”‚ â”‚
â”‚         â”‚                     â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚         â”‚                     â”‚  â”‚                   â”‚                            â”‚
â”‚         â”‚                     â”‚  â”‚                   â–¼                            â”‚
â”‚         â”‚                     â”‚  â”‚         action [B, 30], info (dict)            â”‚
â”‚         â”‚                     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚         â”‚                     â”‚                     â”‚                               â”‚
â”‚         â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚         â”‚                                           â”‚                               
â”‚         â”‚                                           â–¼                               
â”‚         â”‚                                    action [B, 30]                         
â”‚         â”‚                                           â”‚                               
â”‚         â–¼                                           â”‚                               
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              
â”‚  â”‚                  Environment Interaction                          â”‚              
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                             â”‚              
â”‚  â”‚                                                                    â”‚              
â”‚  â”‚  PortfolioOptimizationEnv:                                        â”‚              
â”‚  â”‚    - Apply action (portfolio weights)                             â”‚              
â”‚  â”‚    - Calculate reward (Sharpe/DSR/CVaR)                           â”‚              
â”‚  â”‚    - Update state (prices, balance, shares, indicators)           â”‚              
â”‚  â”‚    - Return (s', r, done, info)                                   â”‚              
â”‚  â”‚                                                                    â”‚              
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              
â”‚                                           â”‚                                         
â”‚                                           â”‚ (s', r, done, info)                     
â”‚                                           â–¼                                         
â”‚                                   Back to Replay Buffer                             
â”‚                                                                                     
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ê³„ì¸µë³„ ë°ì´í„° íë¦„**:

1. **Environment â†’ Policy**: `state [B, 181]`
   - 181-dim: balance(1) + prices(30) + shares(30) + tech_indicators(240Ã—8) + DSR(1) + CVaR(1)

2. **Policy â†’ Actor**: `obs [B, 181]`

3. **Actor â†’ Critic**: `a_j [B, 30]` (ê° í”„ë¡œí† íƒ€ì… ìƒ˜í”Œ)
   - **Critic â†’ Actor**: `fitness [B, M=8]` (Q-values)

4. **Actor Internal**:
   - Market features `[B, 12]` â†’ T-Cell â†’ `crisis_level [B, 1]`, `danger [B, D]`
   - State `[B, 181]` â†’ Epitope Encoder â†’ `E [B, m=6, D=128]`
   - Proto keys `[M=8, D]` â†’ expand â†’ `K [B, M, D]`
   - IRT â†’ `w [B, M]` (í”„ë¡œí† íƒ€ì… ë¯¹ì‹± ê°€ì¤‘ì¹˜)
   - Decoders â†’ `concentrations [B, M, 30]`
   - Mix â†’ `action [B, 30]` (í¬íŠ¸í´ë¦¬ì˜¤ ê°€ì¤‘ì¹˜)

5. **Actor â†’ Environment**: `action [B, 30]`

6. **Environment â†’ Buffer**: `(s, a, r, s', done)`

### Stable Baselines3 í†µí•© íë¦„

**í•™ìŠµ ì‹œ (Training)**:

```
SAC.train()
  â”‚
  â”œâ”€> collect_rollouts() â†’ bufferì— (s,a,r,s') ì €ì¥
  â”‚
  â””â”€> train_step()
       â”‚
       â”œâ”€> Sample batch from buffer
       â”‚
       â”œâ”€> Critic ì—…ë°ì´íŠ¸
       â”‚    â””â”€> Q-loss = MSE(Q(s,a), r + Î³Â·Q_target(s', a'))
       â”‚
       â””â”€> Actor ì—…ë°ì´íŠ¸
            â”‚
            â””â”€> policy.actor.action_log_prob(obs) í˜¸ì¶œ
                 â”‚
                 â””â”€> IRTActorWrapper.action_log_prob(obs)
                      â”‚
                      â”œâ”€> obs.float()  # dtype ë³€í™˜ (float64 â†’ float32)
                      â”‚
                      â”œâ”€> _compute_fitness(obs)  # Critic Q-valueë¡œ fitness ê³„ì‚°
                      â”‚    â”‚
                      â”‚    â””â”€> ê° í”„ë¡œí† íƒ€ì…ì˜ ìƒ˜í”Œ í–‰ë™ì— ëŒ€í•´ Q(s,a) ê³„ì‚°
                      â”‚         fitness[j] = min(Q1(s,aj), Q2(s,aj))
                      â”‚
                      â””â”€> BCellIRTActor(obs, fitness, deterministic=False)
                           â”‚
                           â””â”€> (action, info) ë°˜í™˜
                                â””â”€> log_prob = Dirichlet(mixed_conc).log_prob(action)
```

**í‰ê°€ ì‹œ (Evaluation)**:

```
model.predict(obs, deterministic=True)
  â”‚
  â””â”€> IRTActorWrapper.forward(obs, deterministic=True)
       â”‚
       â”œâ”€> obs.float()
       â”‚
       â”œâ”€> _compute_fitness(obs)  # ë™ì¼í•œ Critic ê¸°ë°˜ fitness
       â”‚
       â””â”€> BCellIRTActor(obs, fitness, deterministic=True)
            â”‚
            â””â”€> action = softmax(mixed_conc / temp)  # ê²°ì •ì  í–‰ë™
```

### BCellIRTActor: IRT í•µì‹¬ êµ¬í˜„

BCellIRTActorëŠ” IRT ì•Œê³ ë¦¬ì¦˜ì˜ ì‹¤ì œ êµ¬í˜„ì²´ë¡œ, 6ë‹¨ê³„ í”„ë¡œì„¸ìŠ¤ë¥¼ ê±°ì³ í–‰ë™ì„ ìƒì„±í•œë‹¤:

```
BCellIRTActor.forward(state, fitness, deterministic)
  â”‚
  â”œâ”€> Step 1: T-Cell ë‹¤ì¤‘ ì‹ í˜¸ ìœ„ê¸° ê°ì§€
  â”‚    â”‚
  â”‚    â”œâ”€> Market features ì¶”ì¶œ (12ì°¨ì›)
  â”‚    â”‚    â”œâ”€ ì‹œì¥ í†µê³„ (4ê°œ): balance, price_mean, price_std, cash_ratio
  â”‚    â”‚    â””â”€ Tech indicators (8ê°œ): macd, boll_ub, boll_lb, rsi_30, cci_30, dx_30, sma_30, sma_60
  â”‚    â”‚
  â”‚    â”œâ”€> TCellMinimal(market_features)
  â”‚    â”‚    â””â”€> crisis_affine, crisis_base_sigmoid, danger_embed
  â”‚    â”‚
  â”‚    â”œâ”€> DSR/CVaR ì‹ í˜¸ ì¶”ì¶œ (state ë§ˆì§€ë§‰ 2ì°¨ì›)
  â”‚    â”‚    â”œâ”€ delta_sharpe: Sharpe ratio gradient (DSR bonus)
  â”‚    â”‚    â””â”€ cvar: Conditional Value at Risk
  â”‚    â”‚
  â”‚    â”œâ”€> EMA ì •ê·œí™” (ê° ì‹ í˜¸ë³„ z-score)
  â”‚    â”‚    â”œâ”€ crisis_base_z = (crisis_affine - Î¼_base) / Ïƒ_base
  â”‚    â”‚    â”œâ”€ sharpe_z = (delta_sharpe - Î¼_sharpe) / Ïƒ_sharpe
  â”‚    â”‚    â””â”€ cvar_z = (cvar - Î¼_cvar) / Ïƒ_cvar
  â”‚    â”‚
  â”‚    â”œâ”€> ë‹¤ì¤‘ ì‹ í˜¸ ê²°í•©
  â”‚    â”‚    crisis_raw = w_rÂ·sigmoid(k_bÂ·base_z)
  â”‚    â”‚                + w_sÂ·sigmoid(-k_sÂ·sharpe_z)  # ìŒìˆ˜: í•˜ë½ ì‹œ ìœ„ê¸°
  â”‚    â”‚                + w_cÂ·sigmoid(k_cÂ·cvar_z)
  â”‚    â”‚
  â”‚    â”œâ”€> ë°”ì´ì–´ìŠ¤/ì˜¨ë„ ë³´ì • (EMA ì ì‘)
  â”‚    â”‚    crisis_affine = (crisis_raw - bias) / temperature
  â”‚    â”‚    crisis_level_pre_guard = sigmoid(crisis_affine)
  â”‚    â”‚    
  â”‚    â”‚    # í•™ìŠµ ì¤‘: biasÂ·temperature ìë™ ì¡°ì • (ëª©í‘œ crisis_pct = p_star)
  â”‚    â”‚    if training:
  â”‚    â”‚        bias += Î·_b Â· (crisis_pct - p_star)
  â”‚    â”‚        temperature *= (1 + Î·_T Â· (crisis_pct - p_star))
  â”‚    â”‚
  â”‚    â”œâ”€> T-Cell Guard (ëª©í‘œ crisis_regime_pct ìœ ë„)
  â”‚    â”‚    crisis_level = crisis_pre_guard + guard_rate Â· (target - crisis_pre_guard)
  â”‚    â”‚
  â”‚    â””â”€> íˆìŠ¤í…Œë¦¬ì‹œìŠ¤ ê¸°ë°˜ ë ˆì§ ì „í™˜
  â”‚         if prev_regime == crisis:
  â”‚             regime = (crisis_level < hysteresis_down) ? normal : crisis
  â”‚         else:
  â”‚             regime = (crisis_level > hysteresis_up) ? crisis : normal
  â”‚
  â”œâ”€> Step 2: ì—í”¼í† í”„ ì¸ì½”ë”©
  â”‚    â””â”€> E = epitope_encoder(state).view(B, m, D)  # [B, m=6, D=128]
  â”‚
  â”œâ”€> Step 3: í”„ë¡œí† íƒ€ì… í™•ì¥
  â”‚    â””â”€> K = proto_keys.expand(B, -1, -1)  # [M=8, D] â†’ [B, M, D]
  â”‚
  â”œâ”€> Step 4: IRT ì—°ì‚°
  â”‚    â””â”€> w, P, debug = IRT(E, K, danger, w_prev, fitness, crisis_level, delta_sharpe)
  â”‚         â”‚
  â”‚         â”œâ”€> [OT Path] êµ¬ì¡°ì  ë§¤ì¹­
  â”‚         â”‚    â”œâ”€ ë©´ì—­í•™ì  ë¹„ìš© í–‰ë ¬ ê³„ì‚°
  â”‚         â”‚    â”‚   C = mahalanobis(E,K) - Î³Â·<E,danger>
  â”‚         â”‚    â”‚       + Î»Â·tolerance_penalty + ÏÂ·checkpoint_penalty
  â”‚         â”‚    â”‚
  â”‚         â”‚    â””â”€ Sinkhorn ì•Œê³ ë¦¬ì¦˜
  â”‚         â”‚         P* = argmin_P <P,C> + ÎµÂ·KL(P||uv^T)
  â”‚         â”‚         w_ot = Î£_i P*(i,j)  # [B, M]
  â”‚         â”‚
  â”‚         â”œâ”€> [Replicator Path] ì‹œê°„ ë©”ëª¨ë¦¬
  â”‚         â”‚    â”œâ”€ ìœ„ê¸° ê°€ì—´: Î·(c) = Î·_0 + Î·_1Â·c
  â”‚         â”‚    â”‚
  â”‚         â”‚    â”œâ”€ Advantage ê³„ì‚°
  â”‚         â”‚    â”‚   A_j = fitness_j - Î£_j w_prev_jÂ·fitness_j
  â”‚         â”‚    â”‚
  â”‚         â”‚    â””â”€ Replicator ë°©ì •ì‹
  â”‚         â”‚         w_rep = softmax(log(w_prev) + Î·Â·A, Ï„=replicator_temp)
  â”‚         â”‚
  â”‚         â”œâ”€> [Dynamic Mixing] ìœ„ê¸° ì ì‘í˜• Î±
  â”‚         â”‚    â”œâ”€ ë™ì  Î± ê³„ì‚°
  â”‚         â”‚    â”‚   Î±_c(c) = Î±_max + (Î±_min - Î±_max)Â·(1 - cos(Ï€c))/2
  â”‚         â”‚    â”‚   c=0 (í‰ì‹œ) â†’ Î±_c=Î±_max (OT ì¦ê°€)
  â”‚         â”‚    â”‚   c=1 (ìœ„ê¸°) â†’ Î±_c=Î±_min (Replicator ì¦ê°€)
  â”‚         â”‚    â”‚
  â”‚         â”‚    â”œâ”€ Sharpe gradient feedback (Phase C)
  â”‚         â”‚    â”‚   Î±_c' = Î±_cÂ·(1 + 0.6Â·tanh(delta_sharpe)) + 0.07Â·tanh(delta_sharpe)
  â”‚         â”‚    â”‚   delta_sharpe > 0 â†’ Î±_c ì¦ê°€ (OT íƒìƒ‰)
  â”‚         â”‚    â”‚   delta_sharpe < 0 â†’ Î±_c ê°ì†Œ (Rep ë³´ìˆ˜ì )
  â”‚         â”‚    â”‚
  â”‚         â”‚    â””â”€ Clamp: Î±_c âˆˆ [Î±_min, Î±_max]
  â”‚         â”‚
  â”‚         â””â”€> [Fusion] ì´ì¤‘ ê²½ë¡œ ê²°í•©
  â”‚              w = (1 - Î±_c)Â·w_rep + Î±_cÂ·w_ot  # [B, M]
  â”‚
  â”œâ”€> Step 5: Dirichlet ì •ì±… (í”„ë¡œí† íƒ€ì… í˜¼í•©)
  â”‚    â”‚
  â”‚    â”œâ”€> ê° í”„ë¡œí† íƒ€ì…ì˜ concentration ê³„ì‚°
  â”‚    â”‚    conc_j = decoder_j(K[:,j,:])  # [B, action_dim]
  â”‚    â”‚    # Tanh output [-1,1] â†’ [0.01, ~10] ë³€í™˜
  â”‚    â”‚    conc_j = clamp(conc_j * 7.5 + 2.5, min=0.01)
  â”‚    â”‚
  â”‚    â”œâ”€> IRT ê°€ì¤‘ì¹˜ë¡œ í˜¼í•©
  â”‚    â”‚    mixed_conc = Î£_j w_j Â· conc_j  # [B, action_dim]
  â”‚    â”‚
  â”‚    â””â”€> í–‰ë™ ìƒì„±
  â”‚         if deterministic:
  â”‚             action = softmax(mixed_conc / action_temp)  # ê²°ì •ì 
  â”‚         else:
  â”‚             action = Dirichlet(clamp(mixed_conc, min, max)).sample()  # í™•ë¥ ì 
  â”‚
  â””â”€> Step 6: EMA ì—…ë°ì´íŠ¸ (ì‹œê°„ ë©”ëª¨ë¦¬)
       if training:
           w_prev = Î²Â·w_prev + (1-Î²)Â·w.mean(dim=0)
```

### ëª¨ë“ˆë³„ ì—­í• 

#### 1. IRTPolicy (SACPolicy ìƒì†)

**ì—­í• **: SB3ì˜ SACì™€ IRT Actorë¥¼ ì—°ê²°í•˜ëŠ” ì •ì±… ì¸í„°í˜ì´ìŠ¤.

**í•µì‹¬ íŒŒë¼ë¯¸í„°**:
- IRT êµ¬ì¡°: `emb_dim=128`, `m_tokens=6`, `M_proto=8`
- ë™ì  í˜¼í•©: `alpha_min=0.08`, `alpha_max=0.45`
- ìœ„ê¸° ì‹ í˜¸: `w_r=0.55`, `w_s=-0.25`, `w_c=0.20`
- T-Cell ê°€ë“œ: `crisis_target=0.5`, `crisis_guard_rate_init=0.30`
- Replicator: `eta_0=0.05`, `eta_1=0.12`, `replicator_temp=1.4`
- OT: `eps=0.03`, `gamma=0.85`

**ì£¼ìš” ë©”ì„œë“œ**:
- `make_actor()`: BCellIRTActorë¥¼ IRTActorWrapperë¡œ ê°ì‹¸ì„œ ìƒì„±
- `get_irt_info()`: ë§ˆì§€ë§‰ forwardì˜ IRT ë””ë²„ê·¸ ì •ë³´ ë°˜í™˜ (í‰ê°€/ì‹œê°í™”ìš©)
- `_get_constructor_parameters()`: ì²´í¬í¬ì¸íŠ¸ ì €ì¥ìš© íŒŒë¼ë¯¸í„°

#### 2. IRTActorWrapper (Actor ì¸í„°í˜ì´ìŠ¤)

**ì—­í• **: BCellIRTActorë¥¼ SACê°€ ê¸°ëŒ€í•˜ëŠ” Actor ì¸í„°í˜ì´ìŠ¤ë¡œ wrappingí•œë‹¤.

**í•µì‹¬ ì„¤ê³„**:
- SACëŠ” `actor(obs)` ì‹œê·¸ë‹ˆì²˜ë¥¼ ê¸°ëŒ€í•˜ì§€ë§Œ, IRTëŠ” `(state, fitness)`ê°€ í•„ìš”
- Wrapperê°€ Critic Q-networkë¡œ fitnessë¥¼ ê³„ì‚°í•˜ì—¬ IRTì— ì „ë‹¬
- `forward()`ì™€ `action_log_prob()`ì´ ë™ì¼í•œ fitness ê³„ì‚° ë¡œì§ ê³µìœ 

**ì£¼ìš” ë©”ì„œë“œ**:

```python
def _compute_fitness(self, obs):
    """Critic Q-value ê¸°ë°˜ í”„ë¡œí† íƒ€ì… fitness ê³„ì‚° (ê³µí†µ helper)"""
    for j in range(M):
        # í”„ë¡œí† íƒ€ì… jì˜ ìƒ˜í”Œ í–‰ë™ ìƒì„±
        conc_j = decoders[j](proto_keys[j])
        a_j = softmax(conc_j)  # Mode approximation
        
        # Twin Q-network ì¤‘ ìµœì†Œê°’ (conservative)
        q1, q2 = critic(obs, a_j)
        fitness[j] = min(q1, q2)
    return fitness

def forward(self, obs, deterministic):
    """í‰ê°€ ì‹œ í–‰ë™ ìƒì„±"""
    obs = obs.float()  # dtype ì•ˆì •ì„±
    fitness = self._compute_fitness(obs)
    action, info = self.irt_actor(obs, fitness, deterministic)
    self._last_irt_info = info  # ì‹œê°í™”ìš© ì €ì¥
    return action

def action_log_prob(self, obs):
    """í•™ìŠµ ì‹œ í–‰ë™ + log_prob ê³„ì‚°"""
    obs = obs.float()
    fitness = self._compute_fitness(obs)  # ë™ì¼í•œ helper
    action, info = self.irt_actor(obs, fitness, deterministic=False)
    
    # Dirichlet log_prob ê³„ì‚° (infoì—ì„œ concentration ì¬ì‚¬ìš©)
    dist = Dirichlet(info['mixed_conc_clamped'])
    log_prob = dist.log_prob(action)
    
    self._last_irt_info = info
    return action, log_prob
```

**ì„¤ê³„ ì´ì **:
- âœ… **ì¼ê´€ì„±**: train/eval ëª¨ë‘ ë™ì¼í•œ fitness ê³„ì‚°
- âœ… **íš¨ìœ¨ì„±**: IRT forwardë¥¼ í•œ ë²ˆë§Œ í˜¸ì¶œ (EMA ë©”ëª¨ë¦¬ ë³´ì¡´)
- âœ… **ì•ˆì •ì„±**: dtype ë³€í™˜ + conservative Q estimate

#### 3. BCellIRTActor (IRT êµ¬í˜„)

**ì—­í• **: IRT ì•Œê³ ë¦¬ì¦˜ì˜ í•µì‹¬ êµ¬í˜„ì²´.

**ì•„í‚¤í…ì²˜ êµ¬ì„±ìš”ì†Œ**:

| ì»´í¬ë„ŒíŠ¸ | íƒ€ì… | í˜•ìƒ | ì—­í•  |
|---------|------|------|------|
| `epitope_encoder` | nn.Sequential | state â†’ [B,mÂ·D] | ìƒíƒœë¥¼ mê°œ í† í°ìœ¼ë¡œ ì¸ì½”ë”© |
| `proto_keys` | nn.Parameter | [M, D] | Mê°œ í•™ìŠµ ê°€ëŠ¥í•œ í”„ë¡œí† íƒ€ì… í‚¤ |
| `decoders` | nn.ModuleList[M] | [D] â†’ [action_dim] | í”„ë¡œí† íƒ€ì…ë³„ Dirichlet ì •ì±… |
| `irt` | IRT | - | OT + Replicator ì—°ì‚°ì |
| `t_cell` | TCellMinimal | [market_dim] â†’ crisis | ìœ„ê¸° ê°ì§€ |
| `w_prev` | buffer | [1, M] | EMA ì‹œê°„ ë©”ëª¨ë¦¬ |

**EMA ë²„í¼** (ìœ„ê¸° ë³´ì • ì‹œìŠ¤í…œ):
- `crisis_bias` [1]: ìœ„ê¸° ë ˆë²¨ ì¤‘ë¦½í™” ë°”ì´ì–´ìŠ¤
- `crisis_temperature` [1]: ìœ„ê¸° ì‹œê·¸ëª¨ì´ë“œ ìŠ¤ì¼€ì¼ë§
- `crisis_prev_regime` [1]: ì´ì „ ë ˆì§ í”Œë˜ê·¸ (íˆìŠ¤í…Œë¦¬ì‹œìŠ¤ìš©)
- `crisis_step` [1]: í•™ìŠµ ìŠ¤í… ì¹´ìš´í„°
- `sharpe_mean/var` [1]: DSR ì‹ í˜¸ ì •ê·œí™” í†µê³„
- `cvar_mean/var` [1]: CVaR ì‹ í˜¸ ì •ê·œí™” í†µê³„
- `crisis_base_mean/var` [1]: T-Cell ë² ì´ìŠ¤ ì‹ í˜¸ ì •ê·œí™” í†µê³„

**Info êµ¬ì¡°** (ë””ë²„ê·¸/ì‹œê°í™”ìš©):

```python
info = {
    # í”„ë¡œí† íƒ€ì… ë¯¹ì‹±
    'w': [B, M],                    # ìµœì¢… í˜¼í•© ê°€ì¤‘ì¹˜
    'w_rep': [B, M],               # Replicator ì¶œë ¥
    'w_ot': [B, M],                # OT ì¶œë ¥
    'P': [B, m, M],                # ìˆ˜ì†¡ ê³„íš
    'fitness': [B, M],             # í”„ë¡œí† íƒ€ì… ì í•©ë„
    
    # ìœ„ê¸° ê°ì§€ (ë‹¤ì¤‘ ì‹ í˜¸)
    'crisis_level': [B, 1],        # ìµœì¢… ìœ„ê¸° ë ˆë²¨ (guard ì ìš© í›„)
    'crisis_level_pre_guard': [B, 1],  # Guard ì ìš© ì „
    'crisis_raw': [B, 1],          # ë‹¤ì¤‘ ì‹ í˜¸ ê°€ì¤‘ í•©ì‚°
    'crisis_base_component': [B, 1],   # T-Cell ê¸°ë³¸ ì‹ í˜¸ (sigmoid)
    'delta_component': [B, 1],     # DSR ê¸°ì—¬ë„ (sigmoid)
    'cvar_component': [B, 1],      # CVaR ê¸°ì—¬ë„ (sigmoid)
    'crisis_regime': [B, 1],       # íˆìŠ¤í…Œë¦¬ì‹œìŠ¤ ë ˆì§ {0,1}
    'crisis_types': [B, K=4],      # ìœ„ê¸° íƒ€ì…ë³„ ì ìˆ˜
    
    # EMA ë³´ì • ìƒíƒœ
    'crisis_bias': [1],            # ë°”ì´ì–´ìŠ¤ (target p_star ìœ ë„ìš©)
    'crisis_temperature': [1],     # ì˜¨ë„ (ìŠ¤ì¼€ì¼ ì¡°ì •ìš©)
    'crisis_prev_regime': [1],     # ì´ì „ ë ˆì§
    'crisis_guard_rate': scalar,   # í˜„ì¬ guard ë¹„ìœ¨
    
    # ì…ë ¥ ì‹ í˜¸ (ì›ë³¸)
    'crisis_base': [B, 1],         # T-Cell ì¶œë ¥ (sigmoid)
    'crisis_base_raw': [B, 1],     # T-Cell ì¶œë ¥ (affine)
    'delta_sharpe': [B, 1],        # DSR bonus
    'cvar': [B, 1],                # CVaR value
    
    # IRT ì—°ì‚°
    'cost_matrix': [B, m, M],      # ë©´ì—­í•™ì  ë¹„ìš©
    'eta': [B, 1],                 # ìœ„ê¸° ê°€ì—´ Î·(c)
    'alpha_c': [B, 1],             # ë™ì  í˜¼í•© ë¹„ìœ¨
    
    # Dirichlet ì •ì±…
    'concentrations': [B, M, action_dim],  # í”„ë¡œí† íƒ€ì…ë³„ concentration
    'mixed_conc': [B, action_dim],         # í˜¼í•© concentration
    'mixed_conc_clamped': [B, action_dim], # Clamp ì ìš© í›„
}
```

#### 4. IRT Operator

**ì—­í• **: Optimal Transportì™€ Replicator Dynamicsë¥¼ ë™ì ìœ¼ë¡œ í˜¼í•©.

**í•µì‹¬ ìˆ˜ì‹**:

```
w_t = (1-Î±_c(c))Â·Replicator(w_{t-1}, f_t, c) + Î±_c(c)Â·Transport(E_t, K, C_t)
```

**ì„¸ë¶€ êµ¬ì„±**:

1. **ë™ì  í˜¼í•© ë¹„ìœ¨** Î±_c(c):
   ```
   Î±_c(c) = Î±_max + (Î±_min - Î±_max) Â· (1 - cos(Ï€c)) / 2
   ```
   - c=0 (í‰ì‹œ) â†’ Î±_c=Î±_max (OT ì¦ê°€, êµ¬ì¡°ì  íƒìƒ‰)
   - c=1 (ìœ„ê¸°) â†’ Î±_c=Î±_min (Replicator ì¦ê°€, ê²€ì¦ëœ ì „ëµ)
   
2. **Sharpe Gradient Feedback** (Phase C):
   ```
   Î±_c' = Î±_cÂ·(1 + 0.6Â·tanh(Î”sharpe)) + 0.07Â·tanh(Î”sharpe)
   Î±_c_final = clamp(Î±_c', Î±_min, Î±_max)
   ```
   - Î”sharpe > 0 (ì„±ëŠ¥ ìƒìŠ¹) â†’ OT ê²½ë¡œ ê°•í™” (íƒìƒ‰ ì§€ì†)
   - Î”sharpe < 0 (ì„±ëŠ¥ í•˜ë½) â†’ Rep ê²½ë¡œ ê°•í™” (ë³´ìˆ˜ì  ì „í™˜)

3. **ìœ„ê¸° ê°€ì—´** Î·(c):
   ```
   Î·(c) = Î·_0 + Î·_1Â·c
   ```
   - í‰ì‹œ: Î·=0.05 (ëŠë¦° ì ì‘)
   - ìœ„ê¸°: Î·=0.17 (ë¹ ë¥¸ ì ì‘)

#### 5. TCellMinimal (ìœ„ê¸° ê°ì§€)

**ì—­í• **: ë‹¤ì¤‘ ì‹ í˜¸ ê¸°ë°˜ ì‹¤ì‹œê°„ ìœ„ê¸° ê°ì§€ ë° ê³µìê·¹ ì„ë² ë”© ìƒì„±.

**ì…ë ¥**: ì‹œì¥ íŠ¹ì„± [B, 12]
- ì‹œì¥ í†µê³„ (4ê°œ): balance, price_mean, price_std, cash_ratio
- ê¸°ìˆ  ì§€í‘œ (8ê°œ): macd, boll_ub, boll_lb, rsi_30, cci_30, dx_30, sma_30, sma_60

**ì¶œë ¥**:
- `z` [B, 4]: ìœ„ê¸° íƒ€ì…ë³„ ì ìˆ˜ (Volatility, Liquidity, Correlation, Systemic)
- `danger_embed` [B, D]: ê³µìê·¹ ì„ë² ë”© (OT ë¹„ìš© í•¨ìˆ˜ìš©)
- `crisis_affine` [B, 1]: ê°€ì¤‘ í•©ì‚° (sigmoid ì „)
- `crisis_base` [B, 1]: ì‹œê·¸ëª¨ì´ë“œ ìœ„ê¸° í™•ë¥ 

**ì•„í‚¤í…ì²˜**:
```python
encoder = Sequential(
    Linear(12, 128),
    LayerNorm(128),
    ReLU(),
    Dropout(0.1),
    Linear(128, 4+D)  # z(4) + danger_embed(D)
)

# ì˜¨ë¼ì¸ ì •ê·œí™” (EMA)
z_std = (z - Î¼) / Ïƒ

# ê°€ì¤‘ í•©ì‚°
crisis_affine = Î£_k softmax(Î±)_k Â· z_std_k
crisis_base = sigmoid(crisis_affine)
```

---

## IRTì˜ í•µì‹¬ ë©”ì»¤ë‹ˆì¦˜

### 1. Optimal Transport (OT)

**ê°œë…**: í˜„ì¬ ìƒíƒœ(ì—í”¼í† í”„)ì™€ ì „ë¬¸ê°€ ì „ëµ(í”„ë¡œí† íƒ€ì…) ê°„ì˜ **ìµœì  ë§¤ì¹­**ì„ ì°¾ëŠ”ë‹¤.

**ìˆ˜í•™ì  ë°°ê²½**:
- Cuturi (2013)ì˜ ì—”íŠ¸ë¡œí”¼ ì •ê·œí™” ìµœì ìˆ˜ì†¡
- Sinkhorn ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ íš¨ìœ¨ì  ê³„ì‚° (O(Îµâ»Â¹log n) ìˆ˜ë ´)

**ë™ì‘ ë°©ì‹**:

```
1. ì—í”¼í† í”„ ì¸ì½”ë”©: E = encoder(state)  # [B, m=6, D=128]
2. í”„ë¡œí† íƒ€ì… í‚¤: K = proto_keys        # [M=8, D]
3. ë©´ì—­í•™ì  ë¹„ìš© ê³„ì‚°:
   C_ij = d_M(E_i, K_j) - Î³Â·<E_i, danger> + Î»Â·tolerance + ÏÂ·checkpoint
   
   - d_M: í•™ìŠµ ê°€ëŠ¥í•œ ë§ˆí• ë¼ë…¸ë¹„ìŠ¤ ê±°ë¦¬
   - Î³Â·<E_i, danger>: ìœ„ê¸° ì‹ í˜¸ì™€ ì •ë ¬ëœ ì—í”¼í† í”„ ì„ í˜¸
   - Î»Â·tolerance: ìê¸°-ë‚´ì„± (ì‹¤íŒ¨ íŒ¨í„´ ì–µì œ)
   - ÏÂ·checkpoint: í”„ë¡œí† íƒ€ì… ê³¼ì‹  ì–µì œ
   
4. Sinkhorn ì•Œê³ ë¦¬ì¦˜:
   P* = argmin_P <P, C> + ÎµÂ·KL(P || uâŠ—v^T)
   
   where:
   - u = 1/m Â· 1_m (ê· ë“± ì†ŒìŠ¤ ë¶„í¬)
   - v = 1/M Â· 1_M (ê· ë“± íƒ€ê²Ÿ ë¶„í¬)
   - Îµ: ì—”íŠ¸ë¡œí”¼ ì •ê·œí™” (exploration)
   
5. OT ë§ˆì§„ (í”„ë¡œí† íƒ€ì…ë³„ ìˆ˜ì†¡ ì§ˆëŸ‰):
   w_ot[j] = Î£_i P*(i, j)  # [B, M]
```

**ì§ê´€**:
- ìœ„ê¸° ìƒí™© â†’ ìœ„ê¸° ì‹ í˜¸(`danger`)ì™€ ì •ë ¬ëœ ì—í”¼í† í”„ì˜ ë¹„ìš© â†“
- OTê°€ ìë™ìœ¼ë¡œ ìœ„ê¸° ëŒ€ì‘ í”„ë¡œí† íƒ€ì… ì„ íƒ
- ì—”íŠ¸ë¡œí”¼ ì •ê·œí™” Îµë¡œ exploration-exploitation ê· í˜•

### 2. Replicator Dynamics

**ê°œë…**: ê³¼ê±°ì— ì„±ê³µí•œ ì „ëµì„ **ì„ í˜¸**í•˜ëŠ” ì‹œê°„ ë©”ëª¨ë¦¬ ë©”ì»¤ë‹ˆì¦˜ (ì§„í™” ê²Œì„ ì´ë¡ ).

**ìˆ˜í•™ì  ë°°ê²½**:
- Hofbauer & Sigmund (1998)ì˜ ë³µì œì ë™ì—­í•™
- ê· í˜•ì ì€ Nash ê· í˜•, ì•ˆì •ì ì€ ESS (Evolutionarily Stable Strategy)

**ë™ì‘ ë°©ì‹**:

```
1. ì´ì „ ê°€ì¤‘ì¹˜ w_{t-1} ê¸°ì–µ (EMA buffer)

2. ê° í”„ë¡œí† íƒ€ì…ì˜ ì í•©ë„ f_j ê³„ì‚° (Critic Q-value ê¸°ë°˜)
   fitness[j] = min(Q1(s, a_j), Q2(s, a_j))
   where a_j = softmax(decoder_j(proto_key_j))

3. Advantage ê³„ì‚° (ë² ì´ìŠ¤ë¼ì¸ ëŒ€ë¹„):
   baseline = Î£_j w_{t-1,j} Â· f_j
   A_j = f_j - baseline

4. ìœ„ê¸° ê°€ì—´:
   Î·(c) = Î·_0 + Î·_1 Â· c
   - í‰ì‹œ (câ‰ˆ0): Î·=0.05 (ëŠë¦° í•™ìŠµ)
   - ìœ„ê¸° (câ‰ˆ1): Î·=0.17 (ë¹ ë¥¸ ì ì‘)

5. ìê¸°-ë‚´ì„± í˜ë„í‹°:
   proto_self_sim = max_k <K_j, sig_k>  # ì‹¤íŒ¨ íŒ¨í„´ ìœ ì‚¬ë„
   r_penalty = 0.5 Â· proto_self_sim

6. Replicator ë°©ì •ì‹ (log-space):
   log_wÌƒ = log(w_{t-1}) + Î· Â· A - r_penalty

7. Temperature softmax (Phase F):
   w_rep = softmax(log_wÌƒ / Ï„)
   - Ï„=1.4 > 1: ë¶„í¬ í‰íƒ„í™” (ê· ë“± ê³ ì°© í•´ì œ)
   - Ï„<1: ì§‘ì¤‘í™” (winner-take-all)
```

**ì§ê´€**:
- ì„±ê³µí•œ í”„ë¡œí† íƒ€ì… (high Q-value) â†’ ê°€ì¤‘ì¹˜ â†‘
- ìœ„ê¸° ì‹œ â†’ Î· â†‘ (ë¹ ë¥¸ ì¬í• ë‹¹)
- ìê¸°-ë‚´ì„± â†’ ë°˜ë³µ ì‹¤ìˆ˜ ì–µì œ
- Temperature â†’ ë‹¤ì–‘ì„± ìœ ì§€

**EMA ì‹œê°„ ë©”ëª¨ë¦¬**:
```
if training:
    w_prev = Î²Â·w_prev + (1-Î²)Â·w.mean(dim=0)
    - Î²=0.70: ë©”ëª¨ë¦¬ ê°•ë„
    - ë°°ì¹˜ í‰ê· ìœ¼ë¡œ ì•ˆì •í™”
```

### 3. ë©´ì—­í•™ì  ë¹„ìš© í•¨ìˆ˜

**ê°œë…**: ë„ë©”ì¸ ì§€ì‹ì„ ë¹„ìš© í•¨ìˆ˜ì— **ë‚´ì¥**í•˜ì—¬ ë” ë‚˜ì€ ì˜ì‚¬ê²°ì • ìœ ë„.

**êµ¬ì„± ìš”ì†Œ**:

```
C_ij = d_M(E_i, K_j) - Î³Â·co_stim + Î»Â·tolerance + ÏÂ·checkpoint
```

#### 3.1 ë§ˆí• ë¼ë…¸ë¹„ìŠ¤ ê±°ë¦¬ (í•™ìŠµ ê°€ëŠ¥)

```
d_M(x, y) = âˆš[(x-y)^T M (x-y)]
where M = L^T L (positive definite)
```

- Lì€ í•™ìŠµ ê°€ëŠ¥í•œ í•˜ì‚¼ê° í–‰ë ¬ (ì´ˆê¸°ê°’: Identity)
- ë°ì´í„° ê³µê°„ì˜ ì¤‘ìš” ì°¨ì›ì„ ìë™ ë°œê²¬

#### 3.2 ê³µìê·¹ (Co-stimulation)

```
co_stim_i = <E_i, danger>
```

- ìœ„ê¸° ì‹ í˜¸(`danger` ì„ë² ë”©)ì™€ ì •ë ¬ëœ ì—í”¼í† í”„ ì„ í˜¸
- ìœ„ê¸° ì‹œ ìœ„í—˜ ì‹ í˜¸ì™€ ìœ ì‚¬í•œ íŒ¨í„´ ìš°ì„  ì„ íƒ
- Î³=0.85: ê³µìê·¹ ê°€ì¤‘ì¹˜

#### 3.3 ë‚´ì„± (Tolerance)

```
tolerance_penalty_i = ReLU(Îº Â· max_k<E_i, sig_k> - Îµ_tol)
```

- `sig_k`: í•™ìŠµ ê°€ëŠ¥í•œ ìê¸°-ë‚´ì„± ì„œëª… (ì‹¤íŒ¨ íŒ¨í„´)
- ê³¼ê±° ì‹¤íŒ¨ì™€ ìœ ì‚¬í•œ ì—í”¼í† í”„ ì–µì œ
- Îº=1.0: ë‚´ì„± ê²Œì¸, Îµ_tol=0.1: ì„ê³„ê°’
- Î»=2.0: ë‚´ì„± ê°€ì¤‘ì¹˜

#### 3.4 ì²´í¬í¬ì¸íŠ¸ (Checkpoint)

```
checkpoint_penalty_j = Ï Â· confidence_j
```

- ê³¼ì‹ í•˜ëŠ” í”„ë¡œí† íƒ€ì… ì–µì œ
- ê³¼ë„í•œ ì§‘ì¤‘ ë°©ì§€ (ë‹¤ì–‘ì„± ìœ ì§€)
- Ï=0.3: ì²´í¬í¬ì¸íŠ¸ ê°€ì¤‘ì¹˜
- (í˜„ì¬ êµ¬í˜„: confidence=0, í–¥í›„ í™•ì¥ ê°€ëŠ¥)

**íš¨ê³¼**:
- ë‹¨ìˆœ ê±°ë¦¬ ê¸°ë°˜ ë§¤ì¹­ë³´ë‹¤ **ì˜ë¯¸ ìˆëŠ” ë§¤ì¹­**
- ìœ„ê¸° ëŒ€ì‘, ì‹¤íŒ¨ íšŒí”¼, ë¶„ì‚° íˆ¬ì ìë™ ìœ ë„
- í•™ìŠµ ê°€ëŠ¥í•œ ë©”íŠ¸ë¦­ìœ¼ë¡œ ë°ì´í„° ì ì‘

---

## ìœ„ê¸° ê°ì§€ ì‹œìŠ¤í…œ

### ë‹¤ì¤‘ ì‹ í˜¸ í†µí•©

IRTëŠ” ì„¸ ê°€ì§€ ë…ë¦½ì  ì‹ í˜¸ë¥¼ ê²°í•©í•˜ì—¬ ìœ„ê¸°ë¥¼ ê°ì§€í•œë‹¤:

```
crisis_raw = w_r Â· sigmoid(k_b Â· crisis_base_z)     # T-Cell ì‹œì¥ ì‹ í˜¸
           + w_s Â· sigmoid(-k_s Â· sharpe_z)         # DSR gradient (ìŒìˆ˜: í•˜ë½=ìœ„ê¸°)
           + w_c Â· sigmoid(k_c Â· cvar_z)            # CVaR (tail risk)
```

**ê¸°ë³¸ ê°€ì¤‘ì¹˜** (Phase 1 calibration):
- `w_r = 0.55`: T-Cell ì‹œì¥ ì‹ í˜¸ (ì£¼ìš” ì„¼ì„œ)
- `w_s = -0.25`: DSR bonus (ì„±ëŠ¥ í•˜ë½ ê°ì§€, ìŒìˆ˜ë¡œ ë°˜ì „)
- `w_c = 0.20`: CVaR (ê¼¬ë¦¬ ìœ„í—˜)

**ê° ì‹ í˜¸ì˜ ì—­í• **:

| ì‹ í˜¸ | ì¸¡ì • ëŒ€ìƒ | z-score ë³€í™˜ | Sigmoid ê¸°ìš¸ê¸° | í•´ì„ |
|-----|----------|-------------|---------------|-----|
| **T-Cell Base** | ì‹œì¥ í†µê³„ + ê¸°ìˆ  ì§€í‘œ | (affine - Î¼)/Ïƒ | k_b=4.0 | ì‹œì¥ êµ¬ì¡°ì  ë³€í™” |
| **DSR Bonus** | Sharpe ratio ë³€í™”ìœ¨ | (Î”sharpe - Î¼)/Ïƒ | k_s=6.0 | ì„±ëŠ¥ ë³€í™” ì¶”ì„¸ |
| **CVaR** | ì¡°ê±´ë¶€ VaR (í•˜ìœ„ 5%) | (cvar - Î¼)/Ïƒ | k_c=6.0 | ê·¹ë‹¨ ì†ì‹¤ ìœ„í—˜ |

### EMA ì •ê·œí™” (Z-Score Normalization)

ê° ì‹ í˜¸ëŠ” ë…ë¦½ì ìœ¼ë¡œ EMA í†µê³„ë¡œ ì •ê·œí™”ëœë‹¤:

```python
# ê° ì‹ í˜¸ë³„ running statistics (momentum=0.95)
signal_z = (signal_raw - Î¼_signal) / Ïƒ_signal

# Sigmoidë¡œ [0,1] ë²”ìœ„ ë³€í™˜
component = sigmoid(k Â· signal_z)
```

**ì´ì **:
- ì‹ í˜¸ ê°„ ìŠ¤ì¼€ì¼ í†µì¼ (ê³µì •í•œ ê¸°ì—¬ë„)
- ë¹„ì •ìƒì„± ë°ì´í„°ì— ì ì‘ (Î¼, Ïƒ ìë™ ê°±ì‹ )
- ê·¹ë‹¨ê°’ì— ê°•ê±´ (outlier ì˜í–¥ ì™„í™”)

### ë°”ì´ì–´ìŠ¤/ì˜¨ë„ ë³´ì • (Phase B)

ìœ„ê¸° ë ˆë²¨ì˜ ì „ì—­ ë¶„í¬ë¥¼ ëª©í‘œ(`p_star=0.35`)ì— ë§ì¶”ê¸° ìœ„í•œ EMA ë³´ì •:

```
crisis_affine = (crisis_raw - bias) / temperature
crisis_level = sigmoid(crisis_affine)

# í•™ìŠµ ì¤‘: EMA ì ì‘ (ì½”ì‚¬ì¸ ê°ì‡ )
if training:
    p_hat = crisis_level.mean()  # ë°°ì¹˜ í‰ê· 
    
    # ë°”ì´ì–´ìŠ¤ ì¡°ì • (ëª©í‘œ ì ìœ ìœ¨ë¡œ ì¤‘ë¦½í™”)
    Î·_b = cosine_decay(Î·_b_max=0.02, Î·_b_min=0.002, steps=30k)
    bias += Î·_b Â· (p_hat - p_star)
    
    # ì˜¨ë„ ì¡°ì • (ë¶„ì‚° ìŠ¤ì¼€ì¼ë§)
    Î·_T = 0.01
    temperature *= (1 + Î·_T Â· (p_hat - p_star))
    temperature = clamp(temperature, 0.9, 1.2)
```

**ëª©ì **:
- ìœ„ê¸° ì ìœ ìœ¨ ì•ˆì •í™” (ê³¼ë„í•œ ìœ„ê¸°/í‰ì‹œ í¸í–¥ ë°©ì§€)
- ì‹ í˜¸ ë“œë¦¬í”„íŠ¸ ë³´ì • (ë¹„ì •ìƒì„± ì‹œê³„ì—´ ì ì‘)
- í•™ìŠµ ì´ˆê¸° ë¹ ë¥´ê²Œ, í›„ê¸° ëŠë¦¬ê²Œ ì¡°ì • (ì½”ì‚¬ì¸ ê°ì‡ )

### T-Cell Guard (ëª©í‘œ crisis_regime_pct ìœ ë„)

ìœ„ê¸° ë ˆì§ ì ìœ ìœ¨ì„ ëª©í‘œ(`crisis_target=0.5`)ë¡œ ìœ ë„í•˜ëŠ” ì„ í˜• ì œì–´:

```
crisis_level_guard = crisis_level_pre_guard 
                   + guard_rate Â· (target - crisis_level_pre_guard)

# Guard ë¹„ìœ¨ ìŠ¤ì¼€ì¤„ (ì›Œë°ì—…)
guard_rate(step) = init + (final - init) Â· min(step / warmup_steps, 1.0)
```

**ê¸°ë³¸ ì„¤ì •**:
- `crisis_target = 0.5`: ëª©í‘œ í‰í˜•ì 
- `guard_rate_init = 0.30`: í•™ìŠµ ì´ˆê¸° ê°•í•œ ìœ ë„
- `guard_rate_final = 0.05`: í•™ìŠµ í›„ê¸°/í‰ê°€ ì•½í•œ ìœ ë„
- `warmup_steps = 10000`: ìŠ¤ì¼€ì¤„ ì›Œë°ì—…

**íš¨ê³¼**:
- í•™ìŠµ ì´ˆê¸°: ìœ„ê¸°/í‰ì‹œ ê· í˜•ì¡íŒ ê²½í—˜ í™•ë³´
- í•™ìŠµ í›„ê¸°: ìì—°ìŠ¤ëŸ¬ìš´ ìœ„ê¸° ê°ì§€ë¡œ ìˆ˜ë ´
- í‰ê°€ ì‹œ: guard_rate=final (ìµœì†Œ ê°„ì„­)

### íˆìŠ¤í…Œë¦¬ì‹œìŠ¤ ë ˆì§ ì „í™˜

ìœ„ê¸°ì™€ í‰ì‹œ ê°„ ì „í™˜ì— íˆìŠ¤í…Œë¦¬ì‹œìŠ¤ë¥¼ ì ìš©í•˜ì—¬ ë–¨ë¦¼(jitter) ë°©ì§€:

```
if prev_regime == CRISIS:
    regime = (crisis_level < hysteresis_down) ? NORMAL : CRISIS
else:  # prev_regime == NORMAL
    regime = (crisis_level > hysteresis_up) ? CRISIS : NORMAL
```

**ê¸°ë³¸ ì„ê³„ê°’**:
- `hysteresis_up = 0.55`: í‰ì‹œ â†’ ìœ„ê¸° (ìƒìŠ¹ ì§„ì…)
- `hysteresis_down = 0.45`: ìœ„ê¸° â†’ í‰ì‹œ (í•˜ê°• ì§„ì…)

**íš¨ê³¼**:
- ë ˆì§ ì „í™˜ ì•ˆì •í™” (ê²½ê³„ì—ì„œ ì§„ë™ ë°©ì§€)
- IRT ì ì‘í˜• ë©”ì»¤ë‹ˆì¦˜ì— ëª…í™•í•œ ì‹ í˜¸ ì œê³µ
- í‰ê°€ ì‹œ ìœ„ê¸° êµ¬ê°„ ì‹ë³„ ìš©ì´

---

## ì ì‘í˜• ë©”ì»¤ë‹ˆì¦˜

### ë™ì  Î± í˜¼í•© (OT-Replicator Balancing)

ìœ„ê¸° ë ˆë²¨ì— ë”°ë¼ OT-Replicator í˜¼í•© ë¹„ìœ¨ì„ ìë™ ì¡°ì ˆ:

```
Î±_c(c) = Î±_max + (Î±_min - Î±_max) Â· (1 - cos(Ï€c)) / 2
```

**ê¸°ë³¸ ë²”ìœ„**:
- `Î±_min = 0.08`: ìœ„ê¸° ì‹œ ìµœì†Œ (Replicator 92%)
- `Î±_max = 0.45`: í‰ì‹œ ìµœëŒ€ (OT 45%)

**ë™ì‘**:
- c=0 (ì™„ì „ í‰ì‹œ) â†’ Î±_c=0.45 (OT ì¦ê°€, êµ¬ì¡°ì  íƒìƒ‰)
- c=0.5 (ê²½ê³„) â†’ Î±_câ‰ˆ0.27 (ê· í˜•)
- c=1 (ì™„ì „ ìœ„ê¸°) â†’ Î±_c=0.08 (Replicator ì¦ê°€, ê²€ì¦ëœ ì „ëµ)

**ì§ê´€**:
- í‰ì‹œ: ìƒˆë¡œìš´ íŒ¨í„´ íƒìƒ‰ (OT ë§¤ì¹­)
- ìœ„ê¸°: ê²€ì¦ëœ ì „ëµ ì„ í˜¸ (Replicator ë©”ëª¨ë¦¬)

### Sharpe Gradient Feedback (Phase C)

Sharpe ratio ë³€í™”ìœ¨ì„ Î±_cì— í”¼ë“œë°±í•˜ì—¬ ì„±ëŠ¥ ì¶”ì„¸ ë°˜ì˜:

```
Î”sharpe = DSR_bonus  # ì…ë ¥ ì‹ í˜¸ (ì›ë³¸ ìŠ¤ì¼€ì¼ ~0.1)
Î±_c' = Î±_c Â· (1 + 0.6Â·tanh(Î”sharpe)) + 0.07Â·tanh(Î”sharpe)
Î±_c_final = clamp(Î±_c', Î±_min, Î±_max)
```

**ë™ì‘**:
- Î”sharpe > 0 (ì„±ëŠ¥ ìƒìŠ¹):
  - Î±_c ì¦ê°€ â†’ OT ê²½ë¡œ ê°•í™” (íƒìƒ‰ ì§€ì†)
- Î”sharpe < 0 (ì„±ëŠ¥ í•˜ë½):
  - Î±_c ê°ì†Œ â†’ Replicator ê²½ë¡œ ê°•í™” (ë³´ìˆ˜ì  ì „í™˜)

**ì´ë“ ì¦í­** (Phase C calibration):
- ê³±ì…ˆ í•­: `0.6Â·tanh(Î”)` (Â±60% ë³€ë™)
- ê°€ë²• í•­: `0.07Â·tanh(Î”)` (ì €Î± ì˜ì—­ íš¨ê³¼ ìœ ì§€)

**íš¨ê³¼**:
- ì„±ëŠ¥ ìƒìŠ¹ ì‹œ íƒìƒ‰ ì§€ì† (ì¢‹ì€ íŒ¨í„´ í™œìš©)
- ì„±ëŠ¥ í•˜ë½ ì‹œ ë°©ì–´ ì „í™˜ (ì†ì‹¤ ì œí•œ)
- Clampë¡œ ê·¹ë‹¨ ë°©ì§€ (ì•ˆì •ì„± í™•ë³´)

### ìœ„ê¸° ê°€ì—´ (Crisis-Adaptive Learning Rate)

Replicator í•™ìŠµë¥ ì„ ìœ„ê¸° ë ˆë²¨ì— ë”°ë¼ ì¡°ì ˆ:

```
Î·(c) = Î·_0 + Î·_1 Â· c
```

**ê¸°ë³¸ ì„¤ì •**:
- `Î·_0 = 0.05`: í‰ì‹œ í•™ìŠµë¥ 
- `Î·_1 = 0.12`: ìœ„ê¸° ì¦ê°€ëŸ‰ (Phase E calibration)

**ë™ì‘**:
- c=0 â†’ Î·=0.05 (ëŠë¦° ì ì‘, ì•ˆì •ì„± ìš°ì„ )
- c=1 â†’ Î·=0.17 (ë¹ ë¥¸ ì ì‘, ë¹ ë¥¸ ì¬í• ë‹¹)

**íš¨ê³¼**:
- í‰ì‹œ: ì™„ë§Œí•œ ê°€ì¤‘ì¹˜ ë³€í™” (ê³¼ì í•© ë°©ì§€)
- ìœ„ê¸°: ì‹ ì†í•œ í”„ë¡œí† íƒ€ì… ì¬í• ë‹¹ (ìœ„ê¸° ëŒ€ì‘)

### Replicator Temperature (Phase F)

Replicator softmaxì— ì˜¨ë„ë¥¼ ì ìš©í•˜ì—¬ ë¶„í¬ í˜•íƒœ ì¡°ì ˆ:

```
w_rep = softmax(log_wÌƒ / Ï„)
```

**ê¸°ë³¸ ì„¤ì •**:
- `Ï„ = 1.4` (Phase F calibration)

**ë™ì‘**:
- Ï„ > 1: ë¶„í¬ í‰íƒ„í™” (ê· ë“± ë¶„í¬ì— ê°€ê¹Œì›€)
- Ï„ = 1: í‘œì¤€ softmax
- Ï„ < 1: ë¶„í¬ ì§‘ì¤‘í™” (winner-take-all)

**íš¨ê³¼**:
- Ï„=1.4 â†’ ê· ë“± í˜¼í•© ê³ ì°© í•´ì œ
- ë‹¤ì–‘í•œ í”„ë¡œí† íƒ€ì…ì— ê°€ì¤‘ì¹˜ ë¶„ì‚°
- íƒìƒ‰ ì´‰ì§„ (exploration)

---

## í”„ë¡œí† íƒ€ì… í•™ìŠµ

### í”„ë¡œí† íƒ€ì… êµ¬ì¡°

IRTëŠ” Mê°œì˜ ì „ë¬¸ê°€ í”„ë¡œí† íƒ€ì…ì„ í•™ìŠµí•œë‹¤:

```python
# í”„ë¡œí† íƒ€ì… í‚¤ (í•™ìŠµ ê°€ëŠ¥)
proto_keys: nn.Parameter [M=8, D=128]
# Xavier ì´ˆê¸°í™”: ~N(0, 1/âˆšD)

# í”„ë¡œí† íƒ€ì…ë³„ Dirichlet ë””ì½”ë”
decoders[j]: Sequential(
    Linear(D, 128),
    ReLU(),
    Dropout(0.1),
    Linear(128, action_dim),
    Tanh()  # [-1, 1] ì¶œë ¥
)
```

**ë³€í™˜**: Tanh â†’ Concentration

```python
# Tanh ì¶œë ¥ [-1,1]ì„ [0.01, ~10] ë²”ìœ„ë¡œ ë³€í™˜
conc_raw = decoder_j(proto_key_j)  # [-1, 1]
conc = clamp(conc_raw * 7.5 + 2.5, min=0.01)  # [0.01, ~10]
```

**ë§¤í•‘**:
- Tanh=-1 â†’ conc=0.01 (ê·¹ë„ë¡œ sparse, íŠ¹ì • ìì‚° ì§‘ì¤‘)
- Tanh=0 â†’ conc=2.5 (ì•½í•œ ë¶„ì‚°)
- Tanh=1 â†’ conc=10.0 (ê°•í•œ ë¶„ì‚°, ê· ë“± ë°©í–¥)

### ë‹¤ì–‘ì„± ì´ˆê¸°í™” (Phase 2.2a)

í”„ë¡œí† íƒ€ì… ê°„ ëŒ€ì¹­ì„±ì„ ê¹¨ê¸° ìœ„í•œ ì´ˆê¸°í™”:

```python
for j, decoder in enumerate(decoders):
    final_linear = decoder[-2]  # ë§ˆì§€ë§‰ Linear ë ˆì´ì–´
    
    # ë¶„ì‚° ì´ˆê¸°í™” (ëŒ€ì¹­ì„± ê¹¨ê¸°)
    torch.nn.init.normal_(final_linear.bias, mean=0.0, std=0.5)
    
    # í”„ë¡œí† íƒ€ì…ë³„ ì˜¤í”„ì…‹ (ë‹¤ì–‘ì„± ìœ ë„)
    final_linear.bias += (j - M/2) * 0.2
```

**íš¨ê³¼**:
- í”„ë¡œí† íƒ€ì… j=-1 â†’ bias-0.8 (cash ì„ í˜¸?)
- í”„ë¡œí† íƒ€ì… j=+1 â†’ bias+0.8 (ì£¼ì‹ ì„ í˜¸?)
- í•™ìŠµ ì´ˆê¸°ë¶€í„° ë‹¤ë¥¸ ì „ëµ íƒìƒ‰

### í”„ë¡œí† íƒ€ì… í˜¼í•©

IRT ê°€ì¤‘ì¹˜ë¡œ í”„ë¡œí† íƒ€ì…ì„ í˜¼í•©í•˜ì—¬ ìµœì¢… ì •ì±… ìƒì„±:

```python
# ê° í”„ë¡œí† íƒ€ì…ì˜ concentration ê³„ì‚°
concentrations = stack([decoders[j](proto_keys[j]) for j in range(M)])
# [B, M, action_dim]

# IRT ê°€ì¤‘ì¹˜ë¡œ í˜¼í•©
mixed_conc = einsum('bm,bma->ba', w, concentrations)
# [B, action_dim]

# í–‰ë™ ìƒì„±
if deterministic:
    action = softmax(mixed_conc / action_temp)  # ê²°ì •ì 
else:
    mixed_conc_clamped = clamp(mixed_conc, dirichlet_min, dirichlet_max)
    action = Dirichlet(mixed_conc_clamped).sample()  # í™•ë¥ ì 
```

### Deterministic vs Stochastic

**Deterministic ëª¨ë“œ** (í‰ê°€ ì‹œ):
```
action = softmax(mixed_conc / Ï„_action)
```
- Softmax ì˜¨ë„ `Ï„_action=0.8` (Phase 2)
- ë‚®ì€ ì˜¨ë„ â†’ ì§‘ì¤‘ëœ ë¶„í¬ (exploitation)
- Dirichletê³¼ **ë‹¤ë¥¸** ë©”ì»¤ë‹ˆì¦˜ (logit ê¸°ë°˜)

**Stochastic ëª¨ë“œ** (í•™ìŠµ ì‹œ):
```
action ~ Dirichlet(clamp(mixed_conc, min, max))
```
- Concentration clamp: `[0.8, 20.0]` (Phase 3.5)
- Î± < 1: Sparse (ëª¨ì„œë¦¬ ì„ í˜¸)
- Î± = 1: Uniform
- Î± > 1: Peaked (ì¤‘ì‹¬ ì„ í˜¸)
- Exploration ìœ ì§€

### Fitness í”¼ë“œë°± ë£¨í”„

í”„ë¡œí† íƒ€ì…ì€ Critic Q-valueë¥¼ í†µí•´ í•™ìŠµëœë‹¤:

```
1. IRTActorWrapper._compute_fitness(obs):
   - ê° í”„ë¡œí† íƒ€ì… jì˜ ìƒ˜í”Œ í–‰ë™ ìƒì„±
     a_j = softmax(decoder_j(proto_key_j))
   - Critic Q-value ê³„ì‚°
     fitness[j] = min(Q1(obs, a_j), Q2(obs, a_j))

2. Replicator Dynamics:
   - fitness ë†’ì€ í”„ë¡œí† íƒ€ì… â†’ w_rep ì¦ê°€
   - í•™ìŠµ ì‹œ w_prev EMA ì—…ë°ì´íŠ¸

3. SAC Actor Loss:
   - action, log_prob = actor.action_log_prob(obs)
   - actor_loss = (Î±Â·log_prob - Q(obs, action)).mean()
   - Gradient â†’ decoder ë° proto_keys ì—…ë°ì´íŠ¸
```

**íš¨ê³¼**:
- Q-value ë†’ì€ í–‰ë™ ìƒì„± í”„ë¡œí† íƒ€ì… ì„ í˜¸
- ë‹¤ì–‘í•œ ì‹œì¥ ìƒí™©ì— íŠ¹í™”ëœ ì „ë¬¸ê°€ í•™ìŠµ
- IRT í˜¼í•©ìœ¼ë¡œ ìƒí™©ë³„ ìµœì  ê²°í•©

| ë©”íŠ¸ë¦­                | SAC Baseline | IRT ëª©í‘œ (Phase 1.4) | ê°œì„ ìœ¨      |
| --------------------- | ------------ | -------------------- | ----------- |
| **Sharpe Ratio**      | 1.0-1.2      | 1.3-1.5              | **+15-20%** |
| **ì „ì²´ Max Drawdown** | -30~-35%     | -18~-23%             | **-25-35%** |
| **ìœ„ê¸° êµ¬ê°„ MDD**     | -40~-45%     | -22~-27%             | **-35-45%** |

**Phase 1.4 ê°œì„ ì‚¬í•­ ë°˜ì˜**:

- Replicator ì™„ì „ í™œì„±í™” (0% â†’ 70%)
- TCell ìœ„ê¸° ê°ì§€ ì •í™•ë„ í–¥ìƒ (ì‹œì¥ í†µê³„ + Tech indicators)
- Train-Eval ì¼ê´€ì„± í™•ë³´

### ìœ„ê¸° êµ¬ê°„ ì§‘ì¤‘

IRTì˜ ì§„ê°€ëŠ” **ìœ„ê¸° êµ¬ê°„**ì—ì„œ ë°œíœ˜ëœë‹¤:

- **2020ë…„ COVID-19**: MDD -40% â†’ -25% (ëª©í‘œ)
- **2022ë…„ Fed ê¸ˆë¦¬ ì¸ìƒ**: MDD -35% â†’ -22% (ëª©í‘œ)
- **ì •ìƒ êµ¬ê°„**: SACì™€ ìœ ì‚¬ (ì•ˆì •ì„± ìœ ì§€)

### í•´ì„ ê°€ëŠ¥ì„±

IRTëŠ” **ë¸”ë™ë°•ìŠ¤ê°€ ì•„ë‹ˆë‹¤**. ë‹¤ìŒ ì •ë³´ë¥¼ ì œê³µí•œë‹¤:

1. **IRT ë¶„í•´**: `w = (1-Î±)Â·w_rep + Î±Â·w_ot`

   - w_rep: ì‹œê°„ ë©”ëª¨ë¦¬ ê¸°ì—¬ë„
   - w_ot: êµ¬ì¡°ì  ë§¤ì¹­ ê¸°ì—¬ë„

2. **T-Cell ìœ„ê¸° ê°ì§€**:

   - ìœ„ê¸° íƒ€ì…ë³„ ì ìˆ˜ (ë³€ë™ì„±, ìœ ë™ì„±, ìƒê´€ê´€ê³„, ì‹œìŠ¤í…œ)
   - ìœ„ê¸° ë ˆë²¨ (0~1)

3. **ë¹„ìš© í–‰ë ¬**:

   - ì—í”¼í† í”„-í”„ë¡œí† íƒ€ì… ê°„ ë©´ì—­í•™ì  ë¹„ìš©
   - ì–´ë–¤ ì „ëµì´ ì™œ ì„ íƒë˜ì—ˆëŠ”ì§€ ì¶”ì 

4. **í”„ë¡œí† íƒ€ì… í•´ì„**:
   - ê° í”„ë¡œí† íƒ€ì…ì´ ì„ í˜¸í•˜ëŠ” ìì‚°
   - ìœ„ê¸° vs ì •ìƒ êµ¬ê°„ í™œì„±í™” íŒ¨í„´

---

## ë‹¤ë¥¸ ì•Œê³ ë¦¬ì¦˜ê³¼ì˜ ë¹„êµ

### í˜¸í™˜ì„± ìš”ì•½

| ì•Œê³ ë¦¬ì¦˜ | IRT ì ìš©     | Fitness ê³„ì‚° | Policy íƒ€ì…   | ê¶Œì¥ë„     |
| -------- | ------------ | ------------ | ------------- | ---------- |
| **SAC**  | âœ… ìµœì       | Q(s,a)       | Stochastic    | â­â­â­â­â­ |
| **TD3**  | âœ… ê°€ëŠ¥      | Q(s,a)       | Deterministic | â­â­â­â­   |
| **DDPG** | âœ… ê°€ëŠ¥      | Q(s,a)       | Deterministic | â­â­â­     |
| **PPO**  | âš ï¸ ìˆ˜ì • í•„ìš” | V(s) ê¸°ë°˜    | Stochastic    | â­â­       |
| **A2C**  | âš ï¸ ìˆ˜ì • í•„ìš” | V(s) ê¸°ë°˜    | Stochastic    | â­â­       |

### SAC (í˜„ì¬ ì‚¬ìš©) â­â­â­â­â­

**ì¥ì **:

- âœ… **Q-network ê¸°ë°˜** â†’ í”„ë¡œí† íƒ€ì… fitness ê³„ì‚° ìš©ì´
- âœ… **Entropy regularization** â†’ IRT explorationê³¼ ì‹œë„ˆì§€
- âœ… **Off-policy** â†’ ìƒ˜í”Œ íš¨ìœ¨ì„± (ê³¼ê±° ê²½í—˜ ì¬ì‚¬ìš©)
- âœ… **Stochastic policy** â†’ Dirichlet ì •ì±…ê³¼ ì™„ë²½ í˜¸í™˜
- âœ… **2 Q-networks (ensemble)** â†’ ì•ˆì •ì„±

**IRTì™€ì˜ ê¶í•©**:

```python
# SACì˜ entropy maximization
max E[Q(s,a)] + Î±_sacÂ·H(Ï€)

# IRTì˜ exploration
- Sinkhorn entropy (Îµ)
- Dirichlet concentration (Î±_k)

# ê²°ê³¼: ì´ì¤‘ exploration â†’ ê°•ê±´í•œ í•™ìŠµ
```

**ì‚¬ìš© ì˜ˆì‹œ**:

```python
from stable_baselines3 import SAC
from finrl.agents.irt import IRTPolicy

model = SAC(
    policy=IRTPolicy,
    env=env,
    policy_kwargs={"alpha": 0.3, "eps": 0.10}
)
```

### TD3 â­â­â­â­

**ì¥ì **:

- âœ… **Q-network ê¸°ë°˜** â†’ fitness ê³„ì‚° ê°€ëŠ¥
- âœ… **Twin Q-networks** â†’ Overestimation ì™„í™”
- âœ… **Off-policy** â†’ ìƒ˜í”Œ íš¨ìœ¨ì„±

**ì°¨ì´ì **:

- âš ï¸ **Deterministic policy** â†’ IRTì˜ `deterministic=True` ëª¨ë“œ ì‚¬ìš©
- âŒ **Entropy regularization ì—†ìŒ** â†’ Exploration ì•½í•¨

**ì ìš© ë°©ë²•**:

```python
from stable_baselines3 import TD3

model = TD3(
    policy=IRTPolicy,  # ë™ì¼í•œ IRT Policy ì‚¬ìš© ê°€ëŠ¥
    env=env,
    policy_kwargs={"alpha": 0.3}
)
# IRT ë‚´ë¶€ì—ì„œ deterministic ëª¨ë“œë¡œ ìë™ ì „í™˜
```

### DDPG â­â­â­

**ì¥ì **:

- âœ… **Q-network ê¸°ë°˜** â†’ fitness ê³„ì‚° ê°€ëŠ¥
- âœ… **Off-policy** â†’ ìƒ˜í”Œ íš¨ìœ¨ì„±
- âœ… **ë‹¨ìˆœ êµ¬ì¡°** â†’ ë¹ ë¥¸ í•™ìŠµ

**ë‹¨ì **:

- âŒ **Single Q-network** â†’ Overestimation ë¬¸ì œ
- âŒ **ë¶ˆì•ˆì •ì„±** â†’ í•™ìŠµ ë°œì‚° ê°€ëŠ¥
- âš ï¸ **Deterministic policy**

**ê¶Œì¥ì‚¬í•­**: TD3 ì‚¬ìš© (DDPG ê°œì„  ë²„ì „)

### PPO â­â­

**ë¬¸ì œì **:

- âŒ **V(s) ê¸°ë°˜ Critic** â†’ Q(s,a) ì—†ìŒ
- âŒ **On-policy** â†’ ê³¼ê±° ê²½í—˜ ì¬ì‚¬ìš© ë¶ˆê°€
- âŒ **IRTì˜ ì‹œê°„ ë©”ëª¨ë¦¬ ì•½í™”**

**ëŒ€ì•ˆ** (êµ¬ì¡° ìˆ˜ì • í•„ìš”):

```python
# Fitnessë¥¼ Advantageë¡œ ê·¼ì‚¬
fitness[j] â‰ˆ A(s, a_j) = r + Î³Â·V(s') - V(s)

# ë¬¸ì œ:
# 1. Episode ëê¹Œì§€ ê¸°ë‹¤ë ¤ì•¼ í•¨ (ì¦‰ì‹œ ê³„ì‚° ë¶ˆê°€)
# 2. ë¶„ì‚° â†‘ (Monte Carlo ì¶”ì •)
# 3. On-policy â†’ w_prev ë©”ëª¨ë¦¬ íš¨ê³¼ ì•½í™”
```

**ê²°ë¡ **: IRTì™€ ê¶í•© ë‚˜ì¨. SAC/TD3 ê¶Œì¥.

### A2C â­â­

PPOì™€ ë™ì¼í•œ ë¬¸ì œ (V(s) ê¸°ë°˜, On-policy).

**ì¶”ê°€ ë‹¨ì **:

- Synchronous update â†’ ëŠë¦° í•™ìŠµ
- PPOì˜ clipping ì—†ìŒ â†’ ë¶ˆì•ˆì •

---

---

## í•˜ì´í¼íŒŒë¼ë¯¸í„° ê°€ì´ë“œ

### IRT êµ¬ì¡° íŒŒë¼ë¯¸í„°

| íŒŒë¼ë¯¸í„° | ê¸°ë³¸ê°’ | ë²”ìœ„ | ì„¤ëª… |
|---------|-------|------|------|
| `emb_dim` | 128 | 64-256 | ì„ë² ë”© ì°¨ì› (ì—í”¼í† í”„, í”„ë¡œí† íƒ€ì…) |
| `m_tokens` | 6 | 4-8 | ì—í”¼í† í”„ í† í° ìˆ˜ (ìƒíƒœ ë‹¤ì¤‘ í‘œí˜„) |
| `M_proto` | 8 | 6-12 | í”„ë¡œí† íƒ€ì… ìˆ˜ (ì „ë¬¸ê°€ ì „ëµ) |
| `market_feature_dim` | 12 | - | T-Cell ì…ë ¥ ì°¨ì› (ê³ ì •) |

### ë™ì  í˜¼í•© íŒŒë¼ë¯¸í„°

| íŒŒë¼ë¯¸í„° | ê¸°ë³¸ê°’ | ë²”ìœ„ | ì„¤ëª… |
|---------|-------|------|------|
| `alpha_min` | 0.08 | 0.05-0.15 | ìœ„ê¸° ì‹œ ìµœì†Œ Î± (Replicator ì¦ê°€) |
| `alpha_max` | 0.45 | 0.35-0.55 | í‰ì‹œ ìµœëŒ€ Î± (OT ì¦ê°€) |
| `ema_beta` | 0.70 | 0.5-0.85 | w_prev EMA ê³„ìˆ˜ (ì‹œê°„ ë©”ëª¨ë¦¬) |

**Î± ë²”ìœ„ ì„ íƒ ê°€ì´ë“œ**:
- `alpha_min` â†“ â†’ ìœ„ê¸° ì‹œ Replicator ë¹„ì¤‘ â†‘ (ë³´ìˆ˜ì )
- `alpha_max` â†‘ â†’ í‰ì‹œ OT íƒìƒ‰ â†‘ (ê³µê²©ì )
- ê¸°ë³¸ ì„¤ì • (0.08, 0.45): ìœ„ê¸° 92% Rep, í‰ì‹œ 45% OT

### ìœ„ê¸° ê°ì§€ íŒŒë¼ë¯¸í„°

| íŒŒë¼ë¯¸í„° | ê¸°ë³¸ê°’ | ë²”ìœ„ | ì„¤ëª… |
|---------|-------|------|------|
| `w_r` | 0.55 | 0.4-0.7 | T-Cell ì‹œì¥ ì‹ í˜¸ ê°€ì¤‘ì¹˜ |
| `w_s` | -0.25 | -0.4~-0.1 | DSR bonus ê°€ì¤‘ì¹˜ (ìŒìˆ˜) |
| `w_c` | 0.20 | 0.1-0.3 | CVaR ê°€ì¤‘ì¹˜ |
| `k_b` | 4.0 | 3.0-6.0 | T-Cell sigmoid ê¸°ìš¸ê¸° |
| `k_s` | 6.0 | 4.0-8.0 | DSR sigmoid ê¸°ìš¸ê¸° |
| `k_c` | 6.0 | 4.0-8.0 | CVaR sigmoid ê¸°ìš¸ê¸° |

**ë‹¤ì¤‘ ì‹ í˜¸ ì¡°ì •**:
- `w_r` â†‘ â†’ ì‹œì¥ êµ¬ì¡° ë¯¼ê° (ì£¼ìš” ì„¼ì„œ)
- `w_s` â†“ (ìŒìˆ˜ ì¦ê°€) â†’ ì„±ëŠ¥ í•˜ë½ ë¯¼ê°
- `w_c` â†‘ â†’ ê¼¬ë¦¬ ìœ„í—˜ ë¯¼ê°

### ë°”ì´ì–´ìŠ¤/ì˜¨ë„ ë³´ì • íŒŒë¼ë¯¸í„°

| íŒŒë¼ë¯¸í„° | ê¸°ë³¸ê°’ | ë²”ìœ„ | ì„¤ëª… |
|---------|-------|------|------|
| `eta_b` | 0.02 | 0.01-0.05 | ë°”ì´ì–´ìŠ¤ ì´ˆê¸° í•™ìŠµë¥  |
| `eta_b_min` | 0.002 | 0.001-0.01 | ë°”ì´ì–´ìŠ¤ ìµœì†Œ í•™ìŠµë¥  (ì½”ì‚¬ì¸ ê°ì‡  í›„) |
| `eta_b_decay_steps` | 30000 | 10k-50k | ë°”ì´ì–´ìŠ¤ ê°ì‡  ìŠ¤í… |
| `eta_T` | 0.01 | 0.005-0.02 | ì˜¨ë„ ì ì‘ í•™ìŠµë¥  |
| `p_star` | 0.35 | 0.3-0.5 | ëª©í‘œ ìœ„ê¸° ì ìœ ìœ¨ |
| `temperature_min` | 0.9 | 0.8-1.0 | ì˜¨ë„ í•˜í•œ |
| `temperature_max` | 1.2 | 1.1-1.5 | ì˜¨ë„ ìƒí•œ |
| `stat_momentum` | 0.95 | 0.9-0.99 | EMA ì •ê·œí™” ëª¨ë©˜í…€ |

### T-Cell Guard íŒŒë¼ë¯¸í„°

| íŒŒë¼ë¯¸í„° | ê¸°ë³¸ê°’ | ë²”ìœ„ | ì„¤ëª… |
|---------|-------|------|------|
| `crisis_target` | 0.5 | 0.4-0.6 | ëª©í‘œ crisis_regime_pct |
| `crisis_guard_rate_init` | 0.30 | 0.2-0.5 | í•™ìŠµ ì´ˆê¸° ê°€ë“œ ë¹„ìœ¨ |
| `crisis_guard_rate_final` | 0.05 | 0.0-0.1 | í•™ìŠµ í›„ê¸°/í‰ê°€ ê°€ë“œ ë¹„ìœ¨ |
| `crisis_guard_warmup_steps` | 10000 | 5k-20k | ê°€ë“œ ìŠ¤ì¼€ì¤„ ì›Œë°ì—… |
| `hysteresis_up` | 0.55 | 0.5-0.7 | í‰ì‹œâ†’ìœ„ê¸° ìƒìŠ¹ ì„ê³„ê°’ |
| `hysteresis_down` | 0.45 | 0.3-0.5 | ìœ„ê¸°â†’í‰ì‹œ í•˜ê°• ì„ê³„ê°’ |

### Replicator íŒŒë¼ë¯¸í„°

| íŒŒë¼ë¯¸í„° | ê¸°ë³¸ê°’ | ë²”ìœ„ | ì„¤ëª… |
|---------|-------|------|------|
| `eta_0` | 0.05 | 0.03-0.08 | ê¸°ë³¸ í•™ìŠµë¥  |
| `eta_1` | 0.12 | 0.05-0.20 | ìœ„ê¸° ì¦ê°€ëŸ‰ (Phase E) |
| `replicator_temp` | 1.4 | 0.9-2.0 | Softmax ì˜¨ë„ (Phase F) |

**Replicator ì¡°ì •**:
- `eta_0` â†‘ â†’ í‰ì‹œ ê°€ì¤‘ì¹˜ ë³€í™” â†‘
- `eta_1` â†‘ â†’ ìœ„ê¸° ì ì‘ ì†ë„ â†‘ (ë¶ˆì•ˆì • ìœ„í—˜)
- `replicator_temp` â†‘ â†’ ë¶„í¬ í‰íƒ„í™” (ë‹¤ì–‘ì„± â†‘)

### OT (Sinkhorn) íŒŒë¼ë¯¸í„°

| íŒŒë¼ë¯¸í„° | ê¸°ë³¸ê°’ | ë²”ìœ„ | ì„¤ëª… |
|---------|-------|------|------|
| `eps` | 0.03 | 0.01-0.1 | ì—”íŠ¸ë¡œí”¼ ì •ê·œí™” (Phase F2') |
| `max_iters` | 30 | 10-50 | Sinkhorn ìµœëŒ€ ë°˜ë³µ |
| `gamma` | 0.85 | 0.5-1.0 | ê³µìê·¹ ê°€ì¤‘ì¹˜ (Phase E) |
| `lambda_tol` | 2.0 | 1.0-3.0 | ë‚´ì„± ê°€ì¤‘ì¹˜ |
| `rho` | 0.3 | 0.1-0.5 | ì²´í¬í¬ì¸íŠ¸ ê°€ì¤‘ì¹˜ |

**OT ì¡°ì •**:
- `eps` â†‘ â†’ ìˆ˜ì†¡ ê³„íš ë¶„ì‚° â†‘ (exploration)
- `eps` â†“ â†’ ìˆ˜ì†¡ ê³„íš ì§‘ì¤‘ â†‘ (exploitation)
- `gamma` â†‘ â†’ ìœ„ê¸° ì‹ í˜¸ ë¯¼ê°ë„ â†‘

### Dirichlet ì •ì±… íŒŒë¼ë¯¸í„°

| íŒŒë¼ë¯¸í„° | ê¸°ë³¸ê°’ | ë²”ìœ„ | ì„¤ëª… |
|---------|-------|------|------|
| `dirichlet_min` | 0.8 | 0.1-1.0 | Concentration ìµœì†Œê°’ (Phase 3.5) |
| `dirichlet_max` | 20.0 | 5.0-50.0 | Concentration ìµœëŒ€ê°’ (Phase F2') |
| `action_temp` | 0.8 | 0.3-1.0 | ê²°ì •ì  í–‰ë™ ì˜¨ë„ (Phase 2) |

**Dirichlet ì¡°ì •**:
- `dirichlet_min` â†“ â†’ í™•ë¥ ì  í–‰ë™ sparse (exploration)
- `dirichlet_max` â†‘ â†’ í™•ë¥ ì  í–‰ë™ peaked (exploitation)
- `action_temp` â†“ â†’ ê²°ì •ì  í–‰ë™ ì§‘ì¤‘ (í‰ê°€ ì‹œ)

### íŒŒë¼ë¯¸í„° Phase ì§„í™”

IRT íŒŒë¼ë¯¸í„°ëŠ” ì—¬ëŸ¬ ë‹¨ê³„ì˜ ì‹¤í—˜ì„ í†µí•´ ë³´ì •ë˜ì—ˆë‹¤:

| Phase | ì£¼ìš” ë³€ê²½ | ëª©ì  |
|-------|---------|------|
| **Phase 1** | ë‹¤ì¤‘ ì‹ í˜¸ ìœ„ê¸° ê°ì§€ (w_r, w_s, w_c) | T-Cell + DSR + CVaR í†µí•© |
| **Phase 2** | action_temp=0.8 ì¶”ê°€ | ê²°ì •ì  í–‰ë™ ë¯¼ê°ë„ |
| **Phase 2.2a** | dirichlet_min=0.1, ema_beta=0.5 | Exploration ì¦ê°€ |
| **Phase 3** | ema_beta=0.70 | ì „ë‹¬ ê°ì‡  ì™„í™” |
| **Phase 3.5** | dirichlet_min=0.8, alpha_min=0.05 | ê· ë“± í¡ì¸ ì™„í™”, Rep ê²½ë¡œ í™•ë³´ |
| **Phase B** | ë°”ì´ì–´ìŠ¤/ì˜¨ë„ ë³´ì • ë„ì… | ìœ„ê¸° ì ìœ ìœ¨ ì•ˆì •í™” |
| **Phase C** | Sharpe gradient feedback | Î±_cì— ì„±ëŠ¥ ì¶”ì„¸ ë°˜ì˜ |
| **Phase E** | eta_1=0.12, gamma=0.85 | Replicator ë¯¼ê°ë„ ì™„í™”, OT í‰í™œí™” |
| **Phase F** | alpha_max=0.45, replicator_temp=1.4 | OT ì¦ê°€, ë¶„í¬ í‰íƒ„í™” |
| **Phase F2'** | eps=0.03, dirichlet_max=20.0 | OT í‰íƒ„í™” ì™„í™”, ê³¼ë„ í¡ì¸ ë°©ì§€ |

**ê¶Œì¥ Ablation Study**:

```bash
# ê¸°ë³¸ ì„¤ì •
python scripts/train_irt.py --episodes 200

# alpha ë²”ìœ„ ì¡°ì •
python scripts/train_irt.py --alpha-min 0.05 --alpha-max 0.55

# ìœ„ê¸° ì‹ í˜¸ ê°€ì¤‘ì¹˜ ì¡°ì •
python scripts/train_irt.py --w-r 0.60 --w-s -0.30

# Replicator ê°€ì—´ ì¡°ì •
python scripts/train_irt.py --eta-1 0.20

# OT ì—”íŠ¸ë¡œí”¼ ì¡°ì •
python scripts/train_irt.py --eps 0.05
```

---

## ì‚¬ìš© ì˜ˆì‹œ

### ê¸°ë³¸ ì‚¬ìš©ë²•

```python
from stable_baselines3 import SAC
from finrl.agents.irt import IRTPolicy

# IRT Policy ì„¤ì •
policy_kwargs = {
    # êµ¬ì¡°
    "emb_dim": 128,
    "m_tokens": 6,
    "M_proto": 8,
    
    # ë™ì  í˜¼í•©
    "alpha_min": 0.08,
    "alpha_max": 0.45,
    "ema_beta": 0.70,
    
    # ìœ„ê¸° ê°ì§€
    "w_r": 0.55,
    "w_s": -0.25,
    "w_c": 0.20,
    
    # Replicator
    "eta_0": 0.05,
    "eta_1": 0.12,
    "replicator_temp": 1.4,
    
    # OT
    "eps": 0.03,
    "gamma": 0.85,
}

# SAC + IRT
model = SAC(
    policy=IRTPolicy,
    env=env,
    policy_kwargs=policy_kwargs,
    learning_rate=1e-4,
    buffer_size=100000,
    batch_size=64,
    verbose=1
)

# í•™ìŠµ
model.learn(total_timesteps=50000)

# ì €ì¥
model.save("logs/irt/irt_model.zip")
```

### CLI ì‚¬ìš©ë²•

```bash
# ê¸°ë³¸ í•™ìŠµ + í‰ê°€
python scripts/train_irt.py --mode both --episodes 200

# í•™ìŠµë§Œ
python scripts/train_irt.py --mode train --episodes 200

# í‰ê°€ë§Œ (ì €ì¥ëœ ëª¨ë¸)
python scripts/train_irt.py --mode eval \
  --model logs/irt/20251005_123456/irt_final.zip

# íŠ¹ì • íŒŒë¼ë¯¸í„°ë¡œ Ablation Study
python scripts/train_irt.py \
  --episodes 200 \
  --alpha-min 0.05 \
  --alpha-max 0.55 \
  --eta-1 0.15

# SAC Baseline í•™ìŠµ (ë¹„êµìš©)
python scripts/train.py --model sac --mode both --episodes 200
```

### ëª¨ë¸ í‰ê°€ ë° ë¹„êµ

```bash
# ë‹¨ì¼ ëª¨ë¸ í‰ê°€
python scripts/evaluate.py \
  --model logs/irt/20251005_123456/irt_final.zip \
  --method direct \
  --save-plot \
  --save-json

# ë‘ ëª¨ë¸ ë¹„êµ (ìë™ ê²½ë¡œ í•´ì„)
python scripts/compare_models.py \
  --model1 logs/sac \
  --model2 logs/irt \
  --output comparison_results

# íŠ¹ì • íƒ€ì„ìŠ¤íƒ¬í”„ ë¹„êµ
python scripts/compare_models.py \
  --model1 logs/sac/20251005_123456 \
  --model2 logs/irt/20251005_234567 \
  --use-best  # best_model ì‚¬ìš©
```

**ìƒì„±ë˜ëŠ” ê²°ê³¼ë¬¼**:

í‰ê°€ ì‹œ:
- `evaluation_results.json`: 10ê°œ ë©”íŠ¸ë¦­ (Sharpe, Calmar, MDD ë“±)
- `evaluation_plots/`: 14ê°œ ì‹œê°í™” (IRTì¼ ê²½ìš°)
  - ì¼ë°˜: portfolio_value, returns, drawdown
  - IRT íŠ¹í™”: irt_decomposition, crisis_levels, prototype_weights, tcell_analysis ë“±

ë¹„êµ ì‹œ:
- `comparison_summary.json`: ë¹„êµ ê²°ê³¼
- `plots/`: 8ê°œ ë¹„êµ í”Œë¡¯
  - portfolio_value_comparison, drawdown_comparison
  - performance_metrics, risk_metrics
  - rolling_sharpe, crisis_response (IRT)

### IRT ì •ë³´ ì¶”ì¶œ (ë””ë²„ê¹…/ë¶„ì„)

```python
# í‰ê°€ ì‹œ IRT ë‚´ë¶€ ì •ë³´ ìˆ˜ì§‘
obs = env.reset()
action, _ = model.predict(obs, deterministic=True)

# IRT ì •ë³´ ê°€ì ¸ì˜¤ê¸° (IRTPolicyì—ì„œ ì œê³µ)
irt_info = model.policy.get_irt_info()

if irt_info:
    # í”„ë¡œí† íƒ€ì… í˜¼í•©
    print(f"í”„ë¡œí† íƒ€ì… ê°€ì¤‘ì¹˜: {irt_info['w']}")  # [B, M]
    print(f"Replicator ê¸°ì—¬: {irt_info['w_rep']}")
    print(f"OT ê¸°ì—¬: {irt_info['w_ot']}")
    
    # ìœ„ê¸° ê°ì§€
    print(f"ìœ„ê¸° ë ˆë²¨: {irt_info['crisis_level']}")  # [B, 1]
    print(f"ìœ„ê¸° ë ˆì§: {irt_info['crisis_regime']}")  # {0,1}
    print(f"ìœ„ê¸° íƒ€ì…ë³„: {irt_info['crisis_types']}")  # [B, 4]
    
    # IRT ì—°ì‚°
    print(f"ë™ì  Î±: {irt_info['alpha_c']}")  # [B, 1]
    print(f"ìœ„ê¸° ê°€ì—´ Î·: {irt_info['eta']}")  # [B, 1]
    print(f"ì í•©ë„: {irt_info['fitness']}")  # [B, M]
    
    # ë‹¤ì¤‘ ì‹ í˜¸
    print(f"T-Cell: {irt_info['crisis_base']}")
    print(f"DSR: {irt_info['delta_sharpe']}")
    print(f"CVaR: {irt_info['cvar']}")
```

### ì‹œê°í™” ìë™ ìƒì„±

IRT ëª¨ë¸ í‰ê°€ ì‹œ 14ê°œ ì‹œê°í™”ê°€ ìë™ ìƒì„±ëœë‹¤:

**ì¼ë°˜ í”Œë¡¯** (3ê°œ):
- `portfolio_value.png`: í¬íŠ¸í´ë¦¬ì˜¤ ê°€ì¹˜ ì¶”ì´
- `returns_distribution.png`: ìˆ˜ìµë¥  ë¶„í¬ (íˆìŠ¤í† ê·¸ë¨)
- `drawdown.png`: Drawdown ì¶”ì´

**IRT íŠ¹í™” í”Œë¡¯** (11ê°œ):
- `irt_decomposition.png`: OT vs Replicator ê¸°ì—¬ë„
- `portfolio_weights.png`: ì‹œê°„ë³„ í¬íŠ¸í´ë¦¬ì˜¤ ê°€ì¤‘ì¹˜
- `crisis_levels.png`: ìœ„ê¸° ë ˆë²¨ ì¶”ì´
- `prototype_weights.png`: í”„ë¡œí† íƒ€ì… í™œì„±í™” íŒ¨í„´
- `stock_analysis.png`: ì¢…ëª©ë³„ ë¹„ì¤‘ ë¶„ì„
- `performance_timeline.png`: ì„±ëŠ¥ ì‹œê³„ì—´
- `benchmark_comparison.png`: ë²¤ì¹˜ë§ˆí¬ ëŒ€ë¹„ ë¹„êµ
- `risk_dashboard.png`: ìœ„í—˜ ì§€í‘œ ëŒ€ì‹œë³´ë“œ
- `tcell_analysis.png`: T-Cell ìœ„ê¸° íƒ€ì… ë¶„ì„
- `attribution_analysis.png`: ì„±ëŠ¥ ê¸°ì—¬ë„ ë¶„ì„
- `cost_matrix.png`: OT ë¹„ìš© í–‰ë ¬ íˆíŠ¸ë§µ

**JSON ê²°ê³¼** (2ê°œ):
- `evaluation_results.json`: 10ê°œ ë©”íŠ¸ë¦­
- `evaluation_insights.json`: IRT íŠ¹í™” ì¸ì‚¬ì´íŠ¸

---

## ì°¸ê³  ë¬¸í—Œ

### ì´ë¡ ì  ê¸°ì´ˆ

1. **Optimal Transport**
   - Cuturi, M. (2013). "Sinkhorn Distances: Lightspeed Computation of Optimal Transport"
   - NIPS 2013
   - IRTì˜ êµ¬ì¡°ì  ë§¤ì¹­ ë©”ì»¤ë‹ˆì¦˜ì˜ ì´ë¡ ì  ê¸°ë°˜

2. **Replicator Dynamics**
   - Hofbauer, J., & Sigmund, K. (1998). "Evolutionary Games and Population Dynamics"
   - Cambridge University Press
   - IRTì˜ ì‹œê°„ ë©”ëª¨ë¦¬ ë©”ì»¤ë‹ˆì¦˜ì˜ ì§„í™” ê²Œì„ ì´ë¡ ì  ê·¼ê±°

3. **Information Geometry**
   - Amari, S. (2016). "Information Geometry and Its Applications"
   - Applied Mathematical Sciences
   - Dirichlet ë¶„í¬ ë° ì •ë³´ê¸°í•˜í•™ì  í•´ì„

### ê°•í™”í•™ìŠµ í”„ë ˆì„ì›Œí¬

4. **FinRL**
   - Liu, X. Y., et al. (2024). "FinRL: Financial Reinforcement Learning Framework"
   - NeurIPS Workshop
   - IRTê°€ í†µí•©ëœ í¬íŠ¸í´ë¦¬ì˜¤ í™˜ê²½

5. **Stable Baselines3**
   - Raffin, A., et al. (2021). "Stable-Baselines3: Reliable Reinforcement Learning Implementations"
   - JMLR
   - SAC ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„ ê¸°ë°˜

### ê¸ˆìœµ ì‘ìš©

6. **Portfolio Optimization**
   - Markowitz, H. (1952). "Portfolio Selection"
   - Journal of Finance
   - í˜„ëŒ€ í¬íŠ¸í´ë¦¬ì˜¤ ì´ë¡ ì˜ ê¸°ì´ˆ

7. **Risk Management**
   - Rockafellar, R. T., & Uryasev, S. (2000). "Optimization of conditional value-at-risk"
   - Journal of Risk
   - CVaR (Conditional Value at Risk) ê°œë…

### ë©´ì—­í•™ì  ì˜ê°

8. **Adaptive Immune System**
   - Janeway, C. A., et al. (2001). "Immunobiology"
   - Garland Science
   - T-Cell, B-Cell, ë©´ì—­í•™ì  ë©”ì»¤ë‹ˆì¦˜ì˜ ìƒë¬¼í•™ì  ë°°ê²½

---

## ì¶”ê°€ ìë£Œ

- **í”„ë¡œì íŠ¸ ë¬¸ì„œ**: [README.md](../README.md)
- **ë³€ê²½ì‚¬í•­ ì´ë ¥**: [CHANGELOG.md](CHANGELOG.md)
- **ìŠ¤í¬ë¦½íŠ¸ ê°€ì´ë“œ**: [SCRIPTS.md](SCRIPTS.md)
- **FinRL ê³µì‹ ë¬¸ì„œ**: [https://finrl.readthedocs.io/](https://finrl.readthedocs.io/)
- **Stable Baselines3 ë¬¸ì„œ**: [https://stable-baselines3.readthedocs.io/](https://stable-baselines3.readthedocs.io/)

---

## ì„±ëŠ¥ ëª©í‘œ ë° ê¸°ëŒ€ íš¨ê³¼

### í•µì‹¬ ëª©í‘œ

IRTëŠ” íŠ¹íˆ **ìœ„ê¸° êµ¬ê°„**ì—ì„œì˜ ì†ì‹¤ ì™„í™”ë¥¼ ëª©í‘œë¡œ í•œë‹¤:

| ë©”íŠ¸ë¦­ | SAC Baseline | IRT ëª©í‘œ | ê°œì„  ë°©í–¥ |
|--------|--------------|----------|-----------|
| **Sharpe Ratio** | 1.0-1.2 | 1.2-1.4 | +10-20% |
| **ì „ì²´ Max Drawdown** | -30~-35% | -20~-25% | -25-35% |
| **ìœ„ê¸° êµ¬ê°„ MDD** | -40~-45% | -25~-30% | -30-40% |

**ìœ„ê¸° êµ¬ê°„ ì •ì˜**:
- 2020ë…„ COVID-19 ì¶©ê²© (2020-03 ~ 2020-06)
- 2022ë…„ Fed ê¸ˆë¦¬ ì¸ìƒ (2022-01 ~ 2022-12)

### í•´ì„ ê°€ëŠ¥ì„±

IRTëŠ” ë¸”ë™ë°•ìŠ¤ê°€ ì•„ë‹ˆë‹¤. ë‹¤ìŒ ì •ë³´ë¥¼ ì œê³µí•œë‹¤:

1. **IRT ë¶„í•´**: `w = (1-Î±_c)Â·w_rep + Î±_cÂ·w_ot`
   - Replicator vs OT ê¸°ì—¬ë„ ì‹œê°í™”
   - ì‹œê°„ ë©”ëª¨ë¦¬ vs êµ¬ì¡°ì  ë§¤ì¹­ ê· í˜•

2. **ë‹¤ì¤‘ ì‹ í˜¸ ìœ„ê¸° ê°ì§€**:
   - T-Cell ì‹œì¥ ì‹ í˜¸ (ì‹œì¥ í†µê³„ + ê¸°ìˆ  ì§€í‘œ)
   - DSR bonus (ì„±ëŠ¥ ì¶”ì„¸)
   - CVaR (ê¼¬ë¦¬ ìœ„í—˜)
   - ê° ì‹ í˜¸ì˜ ê¸°ì—¬ë„ ë¶„ë¦¬

3. **í”„ë¡œí† íƒ€ì… ì „ë¬¸ì„±**:
   - 8ê°œ í”„ë¡œí† íƒ€ì…ì˜ í™œì„±í™” íŒ¨í„´
   - ìœ„ê¸° vs í‰ì‹œ ì„ í˜¸ë„ ë¶„ì„
   - ì¢…ëª©ë³„ íŠ¹í™” ì „ëµ ì‹ë³„

4. **ë¹„ìš© í–‰ë ¬ ë¶„ì„**:
   - ì—í”¼í† í”„-í”„ë¡œí† íƒ€ì… ê°„ ë©´ì—­í•™ì  ë¹„ìš©
   - ì–´ë–¤ ì‹œì¥ ìƒíƒœê°€ ì–´ë–¤ ì „ëµì„ ì„ íƒí–ˆëŠ”ì§€ ì¶”ì 
   - ê³µìê·¹, ë‚´ì„±, ì²´í¬í¬ì¸íŠ¸ ê¸°ì—¬ë„

---

**ë¬¸ì˜**: GitHub Issues ë˜ëŠ” Discussions í™œìš©

**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2025-10-13 (í˜„ì¬ ì½”ë“œë² ì´ìŠ¤ ë°˜ì˜)
